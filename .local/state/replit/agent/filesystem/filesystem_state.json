{"file_contents":{"components/SongPlayer.tsx":{"content":"\"use client\";\n\nimport { useRef, useState } from \"react\";\nimport { FaPlay, FaPause, FaVolumeUp } from \"react-icons/fa\";\nimport { motion } from \"framer-motion\";\n\ninterface SongPlayerProps {\n  audioUrl: string;\n  title: string;\n  isPreview?: boolean;\n  previewDuration?: number;\n}\n\nexport function SongPlayer({\n  audioUrl,\n  title,\n  isPreview = false,\n  previewDuration = 10,\n}: SongPlayerProps) {\n  const audioRef = useRef<HTMLAudioElement>(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [duration, setDuration] = useState(0);\n\n  const togglePlay = () => {\n    if (!audioRef.current) return;\n\n    if (isPlaying) {\n      audioRef.current.pause();\n    } else {\n      audioRef.current.play();\n    }\n    setIsPlaying(!isPlaying);\n  };\n\n  const handleTimeUpdate = () => {\n    if (!audioRef.current) return;\n    const current = audioRef.current.currentTime;\n    setCurrentTime(current);\n\n    if (isPreview && current >= previewDuration) {\n      audioRef.current.pause();\n      audioRef.current.currentTime = 0;\n      setIsPlaying(false);\n    }\n  };\n\n  const handleLoadedMetadata = () => {\n    if (!audioRef.current) return;\n    const totalDuration = isPreview ? previewDuration : audioRef.current.duration;\n    setDuration(totalDuration);\n  };\n\n  const handleSeek = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!audioRef.current) return;\n    const newTime = parseFloat(e.target.value);\n    audioRef.current.currentTime = newTime;\n    setCurrentTime(newTime);\n  };\n\n  const formatTime = (time: number) => {\n    const minutes = Math.floor(time / 60);\n    const seconds = Math.floor(time % 60);\n    return `${minutes}:${seconds.toString().padStart(2, \"0\")}`;\n  };\n\n  return (\n    <div className=\"card\">\n      <div className=\"flex flex-col space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"font-semibold text-lg text-gray-800\">{title}</h3>\n          {isPreview && (\n            <span className=\"text-xs bg-heartbreak-100 text-heartbreak-700 px-3 py-1 rounded-full font-medium\">\n              Preview (10s)\n            </span>\n          )}\n        </div>\n\n        <audio\n          ref={audioRef}\n          src={audioUrl}\n          onTimeUpdate={handleTimeUpdate}\n          onLoadedMetadata={handleLoadedMetadata}\n          onEnded={() => setIsPlaying(false)}\n        />\n\n        <div className=\"flex items-center space-x-4\">\n          <motion.button\n            whileHover={{ scale: 1.1 }}\n            whileTap={{ scale: 0.9 }}\n            onClick={togglePlay}\n            className=\"flex-shrink-0 w-14 h-14 rounded-full bg-gradient-to-r from-heartbreak-500 to-heartbreak-600 flex items-center justify-center text-white shadow-lg hover:shadow-xl transition-shadow\"\n          >\n            {isPlaying ? (\n              <FaPause className=\"text-xl\" />\n            ) : (\n              <FaPlay className=\"text-xl ml-1\" />\n            )}\n          </motion.button>\n\n          <div className=\"flex-1\">\n            <input\n              type=\"range\"\n              min=\"0\"\n              max={duration || 0}\n              value={currentTime}\n              onChange={handleSeek}\n              className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-heartbreak-500\"\n            />\n            <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\n              <span>{formatTime(currentTime)}</span>\n              <span>{formatTime(duration)}</span>\n            </div>\n          </div>\n\n          <div className=\"flex-shrink-0 text-heartbreak-500\">\n            <FaVolumeUp className=\"text-xl\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3704},"app/api/webhook/route.ts":{"content":"import { NextRequest, NextResponse } from \"next/server\";\nimport { prisma } from \"@/lib/prisma\";\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.text();\n    const signature = request.headers.get(\"paddle-signature\") || \"\";\n\n    if (!process.env.PADDLE_API_KEY || !process.env.PADDLE_NOTIFICATION_WEBHOOK_SECRET) {\n      console.warn(\"Paddle credentials not configured - webhook processing disabled\");\n      return NextResponse.json({ received: true, note: \"Credentials not configured\" });\n    }\n\n    let eventData: any;\n    try {\n      const { Paddle } = await import(\"@paddle/paddle-node-sdk\");\n      const paddle = new Paddle(process.env.PADDLE_API_KEY);\n      \n      eventData = await paddle.webhooks.unmarshal(\n        body,\n        process.env.PADDLE_NOTIFICATION_WEBHOOK_SECRET,\n        signature\n      );\n      \n      if (!eventData || !eventData.data) {\n        throw new Error(\"Invalid event data structure\");\n      }\n    } catch (verifyError) {\n      console.error(\"Webhook signature verification failed:\", verifyError);\n      return NextResponse.json(\n        { error: \"Invalid signature\" },\n        { status: 401 }\n      );\n    }\n\n    const existing = await prisma.transaction.findUnique({\n      where: { id: eventData.data.id || `tx-${Date.now()}` },\n    });\n    \n    if (!existing) {\n      await prisma.transaction.create({\n        data: {\n          id: eventData.data.id || `tx-${Date.now()}`,\n          songId: eventData.data.custom_data?.songId || null,\n          userId: eventData.data.custom_data?.userId || null,\n          amount: eventData.data.details?.totals?.total || \"0\",\n          currency: eventData.data.currency_code || \"USD\",\n          status: eventData.data.status || eventData.eventType,\n          paddleData: JSON.stringify(eventData.data),\n        },\n      });\n    } else {\n      console.log(`Transaction ${eventData.data.id} already processed - skipping`);\n      return NextResponse.json({ received: true, note: \"Already processed\" });\n    }\n\n    switch (eventData.eventType) {\n      case \"transaction.completed\":\n        await handleTransactionCompleted(eventData.data);\n        break;\n\n      case \"subscription.created\":\n        await handleSubscriptionCreated(eventData.data);\n        break;\n\n      case \"subscription.updated\":\n        await handleSubscriptionUpdated(eventData.data);\n        break;\n\n      case \"subscription.canceled\":\n        await handleSubscriptionCanceled(eventData.data);\n        break;\n\n      default:\n        console.log(`Unhandled event type: ${eventData.eventType}`);\n    }\n\n    return NextResponse.json({ received: true });\n  } catch (error) {\n    console.error(\"Webhook error:\", error);\n    return NextResponse.json(\n      { error: \"Webhook processing failed\" },\n      { status: 400 }\n    );\n  }\n}\n\nasync function handleTransactionCompleted(transaction: any) {\n  console.log(\"Transaction completed:\", transaction.id);\n  \n  if (!transaction.custom_data) {\n    console.warn(\"No custom_data in transaction - skipping fulfillment\");\n    return;\n  }\n  \n  const { songId, userId } = transaction.custom_data;\n  \n  if (songId) {\n    const song = await prisma.song.findUnique({ where: { id: songId } });\n    \n    if (!song) {\n      console.error(`Song ${songId} not found for transaction ${transaction.id}`);\n      return;\n    }\n    \n    if (song.isPurchased) {\n      console.log(`Song ${songId} already purchased - skipping`);\n      return;\n    }\n    \n    await prisma.song.update({\n      where: { id: songId },\n      data: {\n        isPurchased: true,\n        purchaseTransactionId: transaction.id,\n        userId: userId || null,\n      },\n    });\n    \n    console.log(`Song ${songId} unlocked for user ${userId || 'anonymous'}`);\n  }\n}\n\nasync function handleSubscriptionCreated(subscription: any) {\n  console.log(\"Subscription created:\", subscription.id);\n}\n\nasync function handleSubscriptionUpdated(subscription: any) {\n  console.log(\"Subscription updated:\", subscription.id);\n}\n\nasync function handleSubscriptionCanceled(subscription: any) {\n  console.log(\"Subscription canceled:\", subscription.id);\n}\n","size_bytes":4106},"app/share/[id]/page.tsx":{"content":"\"use client\";\n\nimport { useEffect, useState, useRef } from \"react\";\nimport { useParams } from \"next/navigation\";\nimport { motion } from \"framer-motion\";\nimport Link from \"next/link\";\nimport { Header } from \"@/components/Header\";\nimport { Footer } from \"@/components/Footer\";\nimport { LoadingAnimation } from \"@/components/LoadingAnimation\";\nimport { SocialShareButtons } from \"@/components/SocialShareButtons\";\nimport { LyricsOverlay } from \"@/components/LyricsOverlay\";\nimport { AnimatedBackground } from \"@/components/AnimatedBackground\";\nimport { FaPlay, FaPause, FaDownload, FaLock } from \"react-icons/fa\";\n\ninterface Song {\n  id: string;\n  title: string;\n  previewUrl: string;\n  fullUrl: string;\n  lyrics: string;\n  style: string;\n  story: string;\n  isPurchased: boolean;\n}\n\nexport default function SharePage() {\n  const params = useParams();\n  const songId = params.id as string;\n  \n  const [song, setSong] = useState<Song | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [duration, setDuration] = useState(0);\n  const [actualDuration, setActualDuration] = useState(10);\n  const audioRef = useRef<HTMLAudioElement>(null);\n\n  useEffect(() => {\n    if (songId) {\n      fetchSong(songId);\n    }\n  }, [songId]);\n\n  const fetchSong = async (id: string) => {\n    try {\n      const response = await fetch(`/api/song/${id}`);\n      const data = await response.json();\n      \n      if (data.success) {\n        setSong(data.song);\n      }\n    } catch (error) {\n      console.error(\"Error fetching song:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <LoadingAnimation message=\"Loading song...\" />\n      </div>\n    );\n  }\n\n  if (!song) {\n    return (\n      <div className=\"min-h-screen\">\n        <Header />\n        <main className=\"pt-32 pb-20\">\n          <div className=\"max-w-3xl mx-auto px-4 text-center\">\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-4\">\n              Song not found\n            </h1>\n            <p className=\"text-gray-600 mb-8\">\n              This song may have been deleted or the link is invalid.\n            </p>\n            <Link href=\"/story\">\n              <button className=\"btn-primary\">Create Your Own Song</button>\n            </Link>\n          </div>\n        </main>\n        <Footer />\n      </div>\n    );\n  }\n\n  const togglePlay = () => {\n    if (!audioRef.current) return;\n\n    if (isPlaying) {\n      audioRef.current.pause();\n    } else {\n      audioRef.current.play();\n    }\n    setIsPlaying(!isPlaying);\n  };\n\n  const handleTimeUpdate = () => {\n    if (!audioRef.current) return;\n    const current = audioRef.current.currentTime;\n    setCurrentTime(current);\n\n    if (!song.isPurchased && current >= 10) {\n      audioRef.current.pause();\n      audioRef.current.currentTime = 0;\n      setIsPlaying(false);\n    }\n  };\n\n  const handleLoadedMetadata = () => {\n    if (!audioRef.current) return;\n    const loadedDuration = audioRef.current.duration;\n    setActualDuration(loadedDuration);\n    setDuration(song.isPurchased ? loadedDuration : 10);\n  };\n\n  const formatTime = (time: number) => {\n    const minutes = Math.floor(time / 60);\n    const seconds = Math.floor(time % 60);\n    return `${minutes}:${seconds.toString().padStart(2, \"0\")}`;\n  };\n\n  const shareUrl = typeof window !== 'undefined' ? window.location.href : '';\n\n  return (\n    <div className=\"min-h-screen relative\">\n      <AnimatedBackground />\n      <Header />\n      \n      <main className=\"pt-32 pb-20 relative z-10\">\n        <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n            className=\"space-y-8\"\n          >\n            <div className=\"text-center space-y-4\">\n              <motion.div\n                initial={{ scale: 0 }}\n                animate={{ scale: 1 }}\n                transition={{ delay: 0.2, type: \"spring\" }}\n              >\n                <div className=\"text-6xl mb-4\">üéµüíî</div>\n              </motion.div>\n              <h1 className=\"text-4xl md:text-5xl font-bold text-gray-900\">\n                {song.title}\n              </h1>\n              <p className=\"text-xl text-gray-600\">\n                A healing song generated by AI\n              </p>\n            </div>\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n              <div className=\"space-y-6\">\n                <LyricsOverlay \n                  lyrics={song.lyrics} \n                  duration={song.isPurchased ? actualDuration : 10}\n                  isPlaying={isPlaying}\n                />\n\n                <div className=\"card\">\n                  <h3 className=\"text-xl font-bold text-gray-900 mb-4\">\n                    The Story Behind the Song\n                  </h3>\n                  <p className=\"text-gray-700 italic mb-4\">\"{song.story}\"</p>\n                  <div className=\"flex items-center space-x-2\">\n                    <span className=\"px-3 py-1 bg-healing-200 text-healing-800 rounded-full text-sm font-medium\">\n                      {song.style.charAt(0).toUpperCase() + song.style.slice(1)} Vibe\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"space-y-6\">\n                <div className=\"card sticky top-24\">\n                  <div className=\"space-y-6\">\n                    <div className=\"flex items-center justify-between\">\n                      <h3 className=\"font-semibold text-lg text-gray-800\">Song Preview</h3>\n                      {!song.isPurchased && (\n                        <span className=\"text-xs bg-heartbreak-100 text-heartbreak-700 px-3 py-1 rounded-full font-medium\">\n                          Preview (10s)\n                        </span>\n                      )}\n                    </div>\n\n                    <audio\n                      ref={audioRef}\n                      src={song.isPurchased ? song.fullUrl : song.previewUrl}\n                      onTimeUpdate={handleTimeUpdate}\n                      onLoadedMetadata={handleLoadedMetadata}\n                      onEnded={() => setIsPlaying(false)}\n                    />\n\n                    <div className=\"flex items-center space-x-4\">\n                      <motion.button\n                        whileHover={{ scale: 1.1 }}\n                        whileTap={{ scale: 0.9 }}\n                        onClick={togglePlay}\n                        className=\"w-14 h-14 rounded-full bg-heartbreak-500 hover:bg-heartbreak-600 text-white flex items-center justify-center transition-colors flex-shrink-0\"\n                      >\n                        {isPlaying ? <FaPause className=\"text-xl\" /> : <FaPlay className=\"text-xl ml-1\" />}\n                      </motion.button>\n\n                      <div className=\"flex-1\">\n                        <input\n                          type=\"range\"\n                          min=\"0\"\n                          max={duration}\n                          value={currentTime}\n                          onChange={(e) => {\n                            if (audioRef.current) {\n                              audioRef.current.currentTime = parseFloat(e.target.value);\n                              setCurrentTime(parseFloat(e.target.value));\n                            }\n                          }}\n                          className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-heartbreak-500\"\n                        />\n                        <div className=\"flex justify-between text-xs text-gray-500 mt-2\">\n                          <span>{formatTime(currentTime)}</span>\n                          <span>{formatTime(duration)}</span>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"border-t border-gray-200 pt-6\">\n                      <div className=\"space-y-4\">\n                        <button \n                          className=\"w-full btn-primary flex items-center justify-center space-x-2 bg-gradient-to-r from-heartbreak-500 to-heartbreak-600\"\n                          disabled\n                        >\n                          <FaLock />\n                          <span>Export Full Song (Paid)</span>\n                        </button>\n                        \n                        <Link href=\"/story\">\n                          <button className=\"w-full btn-secondary\">\n                            Create Your Own Song\n                          </button>\n                        </Link>\n                      </div>\n                    </div>\n\n                    <div className=\"border-t border-gray-200 pt-6\">\n                      <h4 className=\"text-sm font-semibold text-gray-700 mb-3\">Share This Song</h4>\n                      <SocialShareButtons \n                        url={shareUrl}\n                        title={song.title}\n                        message={`Check out my AI-generated HeartHeal song: ${song.title}`}\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"card bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 text-center\">\n              <h3 className=\"text-2xl font-bold text-gray-900 mb-4\">\n                üí° Want AI Breakup Advice Too?\n              </h3>\n              <p className=\"text-gray-700 mb-6\">\n                Get personalized healing advice, no-contact strategies, and emotional support from our AI therapist.\n              </p>\n              <Link href=\"/pricing\">\n                <motion.button\n                  whileHover={{ scale: 1.05 }}\n                  whileTap={{ scale: 0.95 }}\n                  className=\"btn-primary bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600\"\n                >\n                  Explore Premium Features\n                </motion.button>\n              </Link>\n            </div>\n          </motion.div>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":10309},"IMPLEMENTATION_NOTES.md":{"content":"# Implementation Notes for Production\n\n## ‚úÖ What's Been Implemented\n\n### Database & Persistence\n- **Prisma ORM with SQLite** - Songs are now stored persistently across server restarts\n- **Database Schema** - Songs and Transactions tables with proper indexing\n- **Idempotent Webhook Processing** - Prevents duplicate transaction processing\n- **Migration Ready** - Uses Prisma schema for easy database migrations\n\n### Paddle Integration\n- **Webhook Signature Verification** - Uses official Paddle SDK for secure verification\n- **Transaction Logging** - All Paddle events are logged to database\n- **Song Unlocking** - Purchases automatically unlock full songs\n- **Idempotency** - Duplicate webhook events are safely ignored\n- **Error Handling** - Validates custom_data and handles missing fields gracefully\n\n### Audio Provider Pattern\n- **Pluggable Architecture** - Easy to swap between placeholder and real audio\n- **Placeholder Provider** - Works out-of-the-box without API keys\n- **ElevenLabs Scaffolding** - Ready for implementation when API key is added\n\n### API Routes\n- **Persistent Storage** - All routes use Prisma instead of in-memory storage\n- **Error Handling** - Proper 404/500 responses with error messages\n- **Type Safety** - TypeScript interfaces for all API requests/responses\n\n### Share & Social Features\n- **Share Page** - Displays song with audio player and story\n- **Open Graph Images** - Dynamic OG image generation for social sharing\n- **Social Buttons** - TikTok, Instagram, WhatsApp, Twitter sharing\n\n---\n\n## üö® Critical Areas for Production\n\nThis document outlines the remaining work needed before deploying to production.\n\n## üö® Critical: Song Storage & Generation\n\n### Current State\n- Songs are stored in-memory (`global.songs`) which is lost on server restart\n- Preview audio uses a placeholder file\n- Full song URLs point to non-existent files\n- **This means users cannot download purchased songs**\n\n### Required Implementation\n\n#### 1. Database Setup\nAdd a proper database (PostgreSQL, MongoDB, etc.) to store:\n```typescript\ninterface Song {\n  id: string;\n  userId?: string;  // Link to authenticated user\n  title: string;\n  story: string;\n  style: 'sad' | 'savage' | 'healing';\n  previewUrl: string;  // S3/Cloud Storage URL\n  fullUrl: string;     // S3/Cloud Storage URL\n  isPurchased: boolean;\n  purchaseTransactionId?: string;\n  createdAt: Date;\n  expiresAt?: Date;\n}\n```\n\n#### 2. File Storage\nSet up cloud storage (AWS S3, Google Cloud Storage, or similar):\n- Store generated audio files persistently\n- Generate signed URLs for secure access\n- Implement expiration for unpurchased previews\n- Keep full songs accessible for purchased users\n\n#### 3. ElevenLabs Integration\nComplete the implementation in `lib/elevenlabs.ts`:\n\n```typescript\n// Example implementation structure\nexport class ElevenLabsMusicAPI {\n  async generateSong(params: {\n    prompt: string;\n    duration: number;\n    style: string;\n  }): Promise<{ previewUrl: string; fullUrl: string }> {\n    // 1. Call ElevenLabs API to generate music\n    const response = await fetch('https://api.elevenlabs.io/v1/text-to-music', {\n      method: 'POST',\n      headers: {\n        'xi-api-key': this.apiKey,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        text: params.prompt,\n        duration_seconds: params.duration,\n      }),\n    });\n\n    const audioData = await response.arrayBuffer();\n\n    // 2. Upload full audio to cloud storage\n    const fullUrl = await uploadToStorage(audioData, 'full');\n\n    // 3. Create 10-second preview\n    const previewData = await createPreview(audioData, 10);\n    const previewUrl = await uploadToStorage(previewData, 'preview');\n\n    return { previewUrl, fullUrl };\n  }\n}\n```\n\nUpdate `app/api/generate-song/route.ts`:\n```typescript\nimport { ElevenLabsMusicAPI } from '@/lib/elevenlabs';\n\nexport async function POST(request: NextRequest) {\n  const { story, style } = await request.json();\n\n  // Generate song using ElevenLabs\n  const elevenlabs = new ElevenLabsMusicAPI(process.env.ELEVENLABS_API_KEY!);\n  const { previewUrl, fullUrl } = await elevenlabs.generateSong({\n    prompt: story,\n    duration: 120,\n    style: style,\n  });\n\n  // Save to database\n  const song = await db.songs.create({\n    title: generateSongTitle(story, style),\n    story,\n    style,\n    previewUrl,\n    fullUrl,\n    isPurchased: false,\n  });\n\n  return NextResponse.json({ success: true, songId: song.id });\n}\n```\n\n## üîê Paddle Webhook Implementation\n\n### Current State\n- Webhook route exists but doesn't verify signatures\n- No actual fulfillment logic\n- No connection between purchases and song access\n\n### Required Implementation\n\n#### 1. Signature Verification\nInstall Paddle Node SDK:\n```bash\nnpm install @paddle/paddle-node-sdk\n```\n\nUpdate `app/api/webhook/route.ts`:\n```typescript\nimport { Paddle } from '@paddle/paddle-node-sdk';\n\nconst paddle = new Paddle(process.env.PADDLE_API_KEY!);\n\nexport async function POST(request: NextRequest) {\n  const body = await request.text();\n  const signature = request.headers.get('paddle-signature') || '';\n\n  try {\n    // Verify webhook signature\n    const eventData = await paddle.webhooks.unmarshal(\n      body,\n      process.env.PADDLE_NOTIFICATION_WEBHOOK_SECRET!,\n      signature\n    );\n\n    // Handle different event types...\n  } catch (error) {\n    return NextResponse.json({ error: 'Invalid signature' }, { status: 401 });\n  }\n}\n```\n\n#### 2. Purchase Fulfillment\nWhen a transaction completes, unlock the song:\n\n```typescript\nasync function handleTransactionCompleted(transaction: any) {\n  const customData = transaction.custom_data;\n  const songId = customData?.songId;\n  const userId = customData?.userId;\n\n  if (songId) {\n    // Unlock the song in database\n    await db.songs.update({\n      where: { id: songId },\n      data: {\n        isPurchased: true,\n        purchaseTransactionId: transaction.id,\n        userId: userId,\n      },\n    });\n\n    // Send email with download link\n    await sendPurchaseConfirmationEmail(transaction.customer_email, songId);\n  }\n}\n```\n\n#### 3. Pass Song ID to Checkout\nUpdate `components/SubscriptionCTA.tsx`:\n```typescript\nconst handleSingleSongPurchase = (songId: string) => {\n  window.Paddle.Checkout.open({\n    items: [{ priceId: 'pri_single_song', quantity: 1 }],\n    customData: {\n      songId: songId,\n      userId: currentUserId, // From auth\n    },\n    settings: {\n      successUrl: `${window.location.origin}/success?songId=${songId}`,\n    },\n  });\n};\n```\n\n## üë§ User Authentication\n\n### Why It's Needed\n- Track which songs belong to which users\n- Allow users to access purchased songs later\n- Prevent unauthorized downloads\n\n### Recommended: Next-Auth\n```bash\nnpm install next-auth\n```\n\nOr use a Replit integration for authentication if available.\n\n## üìä Song Access Control\n\n### Current State\n- Anyone with a song ID can view it\n- No differentiation between preview and full access\n\n### Required Implementation\n\nCreate a download endpoint with access control:\n```typescript\n// app/api/song/[id]/download/route.ts\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: { id: string } }\n) {\n  const songId = params.id;\n  const userId = await getCurrentUserId(request); // From auth\n\n  // Check if user has purchased this song\n  const song = await db.songs.findUnique({\n    where: { id: songId },\n  });\n\n  if (!song) {\n    return NextResponse.json({ error: 'Song not found' }, { status: 404 });\n  }\n\n  // Check access rights\n  if (!song.isPurchased || song.userId !== userId) {\n    return NextResponse.json({ error: 'Unauthorized' }, { status: 403 });\n  }\n\n  // Generate signed download URL (for S3, etc.)\n  const downloadUrl = await generateSignedUrl(song.fullUrl);\n\n  return NextResponse.redirect(downloadUrl);\n}\n```\n\n## üîÑ Share Page Metadata\n\nAdd Open Graph tags for social sharing in `app/share/[id]/page.tsx`:\n\n```typescript\nexport async function generateMetadata({ params }: { params: { id: string } }) {\n  const song = await fetchSongFromDB(params.id);\n\n  return {\n    title: song.title,\n    description: `Listen to this AI-generated breakup song: ${song.story.substring(0, 150)}...`,\n    openGraph: {\n      title: song.title,\n      description: song.story,\n      images: ['/og-image.png'], // Create a dynamic OG image\n      type: 'music.song',\n    },\n    twitter: {\n      card: 'summary_large_image',\n      title: song.title,\n      description: song.story,\n    },\n  };\n}\n```\n\n## üìù Environment Variables Checklist\n\nBefore going to production, ensure these are set:\n\n```bash\n# Paddle (Production Mode)\nNEXT_PUBLIC_PADDLE_CLIENT_TOKEN=your_production_client_token\nNEXT_PUBLIC_PADDLE_ENVIRONMENT=production\nNEXT_PUBLIC_PADDLE_PRICE_STANDARD=pri_production_standard\nNEXT_PUBLIC_PADDLE_PRICE_PREMIUM=pri_production_premium\nNEXT_PUBLIC_PADDLE_PRICE_SINGLE=pri_production_single_song\nPADDLE_API_KEY=your_production_api_key\nPADDLE_NOTIFICATION_WEBHOOK_SECRET=your_webhook_secret\n\n# ElevenLabs\nELEVENLABS_API_KEY=your_elevenlabs_api_key\n\n# Database\nDATABASE_URL=your_production_database_url\n\n# File Storage\nAWS_ACCESS_KEY_ID=your_aws_key\nAWS_SECRET_ACCESS_KEY=your_aws_secret\nAWS_BUCKET_NAME=your_bucket_name\nAWS_REGION=us-east-1\n\n# Auth (if using NextAuth)\nNEXTAUTH_URL=https://your-production-domain.com\nNEXTAUTH_SECRET=your_random_secret\n```\n\n## üöÄ Deployment Checklist\n\nBefore deploying:\n\n- [ ] Set up production database\n- [ ] Configure cloud storage for audio files\n- [ ] Implement ElevenLabs integration\n- [ ] Add user authentication\n- [ ] Implement webhook signature verification\n- [ ] Add purchase fulfillment logic\n- [ ] Create access control for song downloads\n- [ ] Test full user journey end-to-end\n- [ ] Set up monitoring and error tracking\n- [ ] Configure Paddle webhook URL in dashboard\n- [ ] Switch Paddle to production mode\n- [ ] Test actual payment with real card\n- [ ] Verify emails are being sent\n- [ ] Add rate limiting to API routes\n- [ ] Set up CDN for audio files\n\n## üìö Additional Resources\n\n- [Paddle Billing Documentation](https://developer.paddle.com/)\n- [ElevenLabs API Docs](https://elevenlabs.io/docs)\n- [Next.js App Router](https://nextjs.org/docs/app)\n- [AWS S3 Signed URLs](https://docs.aws.amazon.com/AmazonS3/latest/userguide/ShareObjectPreSignedURL.html)\n\n---\n\n**Note**: This app is currently a functional prototype. The above implementations are REQUIRED before accepting real payments from users.\n","size_bytes":10412},"app/preview/page.tsx":{"content":"\"use client\";\n\nimport { useEffect, useState, useRef } from \"react\";\nimport { useSearchParams } from \"next/navigation\";\nimport { motion } from \"framer-motion\";\nimport { Header } from \"@/components/Header\";\nimport { Footer } from \"@/components/Footer\";\nimport { SubscriptionCTA } from \"@/components/SubscriptionCTA\";\nimport { SocialShareButtons } from \"@/components/SocialShareButtons\";\nimport { LoadingAnimation } from \"@/components/LoadingAnimation\";\nimport { LyricsOverlay } from \"@/components/LyricsOverlay\";\nimport { AnimatedBackground } from \"@/components/AnimatedBackground\";\nimport { FaLock, FaDownload, FaPlay, FaPause } from \"react-icons/fa\";\n\ninterface Song {\n  id: string;\n  title: string;\n  previewUrl: string;\n  fullUrl: string;\n  lyrics: string;\n  style: string;\n  story: string;\n  isPurchased: boolean;\n}\n\nexport default function PreviewPage() {\n  const searchParams = useSearchParams();\n  const songId = searchParams.get(\"songId\");\n  \n  const [song, setSong] = useState<Song | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [showSubscription, setShowSubscription] = useState(false);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [duration, setDuration] = useState(0);\n  const [actualDuration, setActualDuration] = useState(10);\n  const audioRef = useRef<HTMLAudioElement>(null);\n\n  useEffect(() => {\n    if (songId) {\n      fetchSong(songId);\n    }\n  }, [songId]);\n\n  const fetchSong = async (id: string) => {\n    try {\n      const response = await fetch(`/api/song/${id}`);\n      const data = await response.json();\n      \n      if (data.success) {\n        setSong(data.song);\n      } else {\n        console.error(\"Failed to fetch song\");\n      }\n    } catch (error) {\n      console.error(\"Error fetching song:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <LoadingAnimation message=\"Loading your song...\" />\n      </div>\n    );\n  }\n\n  if (!song) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-center space-y-4\">\n          <h1 className=\"text-3xl font-bold text-gray-900\">Song not found</h1>\n          <p className=\"text-gray-600\">Please try generating a new song</p>\n        </div>\n      </div>\n    );\n  }\n\n  const togglePlay = () => {\n    if (!audioRef.current) return;\n\n    if (isPlaying) {\n      audioRef.current.pause();\n    } else {\n      audioRef.current.play();\n    }\n    setIsPlaying(!isPlaying);\n  };\n\n  const handleTimeUpdate = () => {\n    if (!audioRef.current) return;\n    const current = audioRef.current.currentTime;\n    setCurrentTime(current);\n\n    if (!song.isPurchased && current >= 10) {\n      audioRef.current.pause();\n      audioRef.current.currentTime = 0;\n      setIsPlaying(false);\n    }\n  };\n\n  const handleLoadedMetadata = () => {\n    if (!audioRef.current) return;\n    const loadedDuration = audioRef.current.duration;\n    setActualDuration(loadedDuration);\n    setDuration(song.isPurchased ? loadedDuration : 10);\n  };\n\n  const formatTime = (time: number) => {\n    const minutes = Math.floor(time / 60);\n    const seconds = Math.floor(time % 60);\n    return `${minutes}:${seconds.toString().padStart(2, \"0\")}`;\n  };\n\n  const shareUrl = typeof window !== 'undefined' ? `${window.location.origin}/share/${song?.id}` : '';\n\n  return (\n    <div className=\"min-h-screen relative\">\n      <AnimatedBackground />\n      <Header />\n      \n      <main className=\"pt-32 pb-20 relative z-10\">\n        <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n            className=\"space-y-8\"\n          >\n            <div className=\"text-center space-y-4\">\n              <motion.div\n                initial={{ scale: 0 }}\n                animate={{ scale: 1 }}\n                transition={{ delay: 0.2, type: \"spring\" }}\n                className=\"inline-block\"\n              >\n                <div className=\"text-6xl mb-4\">üéµ</div>\n              </motion.div>\n              <h1 className=\"text-4xl md:text-5xl font-bold text-gray-900\">\n                Your Song is <span className=\"text-gradient\">Ready!</span>\n              </h1>\n              <p className=\"text-xl text-gray-600\">\n                Listen to your preview and see the lyrics come to life!\n              </p>\n            </div>\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n              <div className=\"space-y-6\">\n                <LyricsOverlay \n                  lyrics={song.lyrics} \n                  duration={song.isPurchased ? actualDuration : 10}\n                  isPlaying={isPlaying}\n                />\n\n                <div className=\"card bg-healing-50 border-healing-200\">\n                  <h3 className=\"text-xl font-bold text-gray-900 mb-4\">\n                    Your Breakup Story\n                  </h3>\n                  <p className=\"text-gray-700 italic mb-4\">\"{song.story}\"</p>\n                  <div className=\"flex items-center space-x-2\">\n                    <span className=\"px-3 py-1 bg-healing-200 text-healing-800 rounded-full text-sm font-medium\">\n                      {song.style.charAt(0).toUpperCase() + song.style.slice(1)} Vibe\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"space-y-6\">\n                <div className=\"card sticky top-24\">\n                  <div className=\"space-y-6\">\n                    <div className=\"flex items-center justify-between\">\n                      <h3 className=\"font-semibold text-lg text-gray-800\">{song.title}</h3>\n                      {!song.isPurchased && (\n                        <span className=\"text-xs bg-heartbreak-100 text-heartbreak-700 px-3 py-1 rounded-full font-medium\">\n                          Preview (10s)\n                        </span>\n                      )}\n                    </div>\n\n                    <audio\n                      ref={audioRef}\n                      src={song.isPurchased ? song.fullUrl : song.previewUrl}\n                      onTimeUpdate={handleTimeUpdate}\n                      onLoadedMetadata={handleLoadedMetadata}\n                      onEnded={() => setIsPlaying(false)}\n                    />\n\n                    <div className=\"flex items-center space-x-4\">\n                      <motion.button\n                        whileHover={{ scale: 1.1 }}\n                        whileTap={{ scale: 0.9 }}\n                        onClick={togglePlay}\n                        className=\"w-14 h-14 rounded-full bg-heartbreak-500 hover:bg-heartbreak-600 text-white flex items-center justify-center transition-colors flex-shrink-0\"\n                      >\n                        {isPlaying ? <FaPause className=\"text-xl\" /> : <FaPlay className=\"text-xl ml-1\" />}\n                      </motion.button>\n\n                      <div className=\"flex-1\">\n                        <input\n                          type=\"range\"\n                          min=\"0\"\n                          max={duration}\n                          value={currentTime}\n                          onChange={(e) => {\n                            if (audioRef.current) {\n                              audioRef.current.currentTime = parseFloat(e.target.value);\n                              setCurrentTime(parseFloat(e.target.value));\n                            }\n                          }}\n                          className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-heartbreak-500\"\n                        />\n                        <div className=\"flex justify-between text-xs text-gray-500 mt-2\">\n                          <span>{formatTime(currentTime)}</span>\n                          <span>{formatTime(duration)}</span>\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"border-t border-gray-200 pt-6\">\n                      <h4 className=\"text-sm font-semibold text-gray-700 mb-3\">Share Your Song</h4>\n                      <SocialShareButtons \n                        url={shareUrl}\n                        title={song.title}\n                        message={`Check out my AI-generated HeartHeal song: ${song.title}`}\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"card bg-gradient-to-br from-heartbreak-50 to-heartbreak-100 border-2 border-heartbreak-200\">\n              <div className=\"flex items-start space-x-4\">\n                <div className=\"flex-shrink-0\">\n                  <FaLock className=\"text-3xl text-heartbreak-500\" />\n                </div>\n                <div className=\"flex-1\">\n                  <h3 className=\"text-xl font-bold text-gray-900 mb-2\">\n                    Unlock the Full Song\n                  </h3>\n                  <p className=\"text-gray-600 mb-4\">\n                    Love what you hear? Get the complete song, download it as an MP3, \n                    and share it with the world. Choose a subscription or buy just this one song.\n                  </p>\n                  {!showSubscription && (\n                    <motion.button\n                      whileHover={{ scale: 1.05 }}\n                      whileTap={{ scale: 0.95 }}\n                      onClick={() => setShowSubscription(true)}\n                      className=\"btn-primary flex items-center space-x-2\"\n                    >\n                      <FaDownload />\n                      <span>Unlock Full Song</span>\n                    </motion.button>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            {showSubscription && (\n              <motion.div\n                initial={{ opacity: 0, height: 0 }}\n                animate={{ opacity: 1, height: \"auto\" }}\n                transition={{ duration: 0.5 }}\n              >\n                <SubscriptionCTA />\n              </motion.div>\n            )}\n\n            <div className=\"card bg-blue-50 border-blue-200\">\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"text-2xl\">üíô</div>\n                <div>\n                  <h3 className=\"font-semibold text-gray-900 mb-2\">\n                    Premium Members Get:\n                  </h3>\n                  <ul className=\"space-y-1 text-sm text-gray-700\">\n                    <li>‚Ä¢ AI-powered breakup advice tailored to your situation</li>\n                    <li>‚Ä¢ No-contact tips and daily affirmations</li>\n                    <li>‚Ä¢ Healing playlists and meditation guides</li>\n                    <li>‚Ä¢ Priority support from our community</li>\n                  </ul>\n                  {!showSubscription && (\n                    <button\n                      onClick={() => setShowSubscription(true)}\n                      className=\"mt-4 text-heartbreak-600 font-semibold hover:text-heartbreak-700 transition-colors\"\n                    >\n                      Learn More ‚Üí\n                    </button>\n                  )}\n                </div>\n              </div>\n            </div>\n          </motion.div>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":11453},"lib/audio-provider.ts":{"content":"export interface AudioProvider {\n  generateSong(params: {\n    story: string;\n    style: string;\n  }): Promise<{ previewUrl: string; fullUrl: string }>;\n}\n\nclass PlaceholderAudioProvider implements AudioProvider {\n  async generateSong(params: { story: string; style: string }): Promise<{ previewUrl: string; fullUrl: string }> {\n    return {\n      previewUrl: '/audio/sample-preview.mp3',\n      fullUrl: '/audio/sample-preview.mp3',\n    };\n  }\n}\n\nclass ElevenLabsAudioProvider implements AudioProvider {\n  private apiKey: string;\n\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n  }\n\n  async generateSong(params: { story: string; style: string }): Promise<{ previewUrl: string; fullUrl: string }> {\n    throw new Error('ElevenLabs integration not yet implemented. Add your API key and implementation here.');\n  }\n}\n\nexport function getAudioProvider(): AudioProvider {\n  const apiKey = process.env.ELEVENLABS_API_KEY;\n  \n  if (apiKey && apiKey !== '') {\n    return new ElevenLabsAudioProvider(apiKey);\n  }\n  \n  return new PlaceholderAudioProvider();\n}\n","size_bytes":1060},"next.config.ts":{"content":"import type { NextConfig } from \"next\";\n\nconst nextConfig: NextConfig = {\n  reactStrictMode: true,\n  poweredByHeader: false,\n  compress: true,\n  images: {\n    formats: ['image/avif', 'image/webp'],\n  },\n};\n\nexport default nextConfig;\n","size_bytes":234},"components/StyleSelector.tsx":{"content":"\"use client\";\n\nimport { motion } from \"framer-motion\";\nimport { FaSadTear, FaFire, FaSeedling, FaMusic, FaLaugh } from \"react-icons/fa\";\nimport clsx from \"clsx\";\n\nexport type SongStyle = \"sad\" | \"savage\" | \"healing\" | \"vibe\" | \"meme\";\n\ninterface StyleSelectorProps {\n  selected: SongStyle;\n  onChange: (style: SongStyle) => void;\n}\n\nconst styles = [\n  {\n    id: \"sad\" as SongStyle,\n    name: \"Sad\",\n    icon: FaSadTear,\n    description: \"Pour your heart out\",\n    color: \"from-blue-400 to-blue-600\",\n    bgColor: \"bg-blue-50\",\n    borderColor: \"border-blue-400\",\n  },\n  {\n    id: \"savage\" as SongStyle,\n    name: \"Savage\",\n    icon: FaFire,\n    description: \"Unleash your rage\",\n    color: \"from-red-500 to-orange-600\",\n    bgColor: \"bg-red-50\",\n    borderColor: \"border-red-400\",\n  },\n  {\n    id: \"healing\" as SongStyle,\n    name: \"Healing\",\n    icon: FaSeedling,\n    description: \"Find your peace\",\n    color: \"from-green-400 to-emerald-600\",\n    bgColor: \"bg-green-50\",\n    borderColor: \"border-green-400\",\n  },\n  {\n    id: \"vibe\" as SongStyle,\n    name: \"Vibe\",\n    icon: FaMusic,\n    description: \"Chill & relatable\",\n    color: \"from-purple-400 to-indigo-600\",\n    bgColor: \"bg-purple-50\",\n    borderColor: \"border-purple-400\",\n  },\n  {\n    id: \"meme\" as SongStyle,\n    name: \"Meme\",\n    icon: FaLaugh,\n    description: \"Make it funny\",\n    color: \"from-yellow-400 to-orange-500\",\n    bgColor: \"bg-yellow-50\",\n    borderColor: \"border-yellow-400\",\n  },\n];\n\nexport function StyleSelector({ selected, onChange }: StyleSelectorProps) {\n  return (\n    <div className=\"space-y-4\">\n      <label className=\"block text-lg font-semibold text-gray-700\">\n        Choose Your Vibe\n      </label>\n      <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4\">\n        {styles.map((style) => {\n          const Icon = style.icon;\n          const isSelected = selected === style.id;\n          \n          return (\n            <motion.button\n              key={style.id}\n              onClick={() => onChange(style.id)}\n              whileHover={{ scale: 1.05, y: -5 }}\n              whileTap={{ scale: 0.95 }}\n              className={clsx(\n                \"p-6 rounded-2xl border-2 transition-all duration-300 text-left\",\n                isSelected\n                  ? `${style.bgColor} ${style.borderColor} shadow-lg`\n                  : \"bg-white border-gray-200 hover:border-gray-300 shadow-md\"\n              )}\n            >\n              <div className=\"flex flex-col items-center space-y-3\">\n                <div\n                  className={clsx(\n                    \"p-4 rounded-full bg-gradient-to-br\",\n                    style.color\n                  )}\n                >\n                  <Icon className=\"text-3xl text-white\" />\n                </div>\n                <div className=\"text-center\">\n                  <h3 className=\"font-bold text-lg text-gray-900\">\n                    {style.name}\n                  </h3>\n                  <p className=\"text-sm text-gray-600\">{style.description}</p>\n                </div>\n              </div>\n            </motion.button>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n","size_bytes":3147},"app/api/generate-song/route.ts":{"content":"import { NextRequest, NextResponse } from 'next/server';\nimport { prisma } from '@/lib/prisma';\nimport { SongStyle } from '@/lib/lyrics';\nimport { createOpenRouterClient } from '@/lib/openrouter';\nimport { createSunoClient } from '@/lib/suno';\n\ninterface GenerateSongRequest {\n  story: string;\n  style: SongStyle;\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body: GenerateSongRequest = await request.json();\n    const { story, style } = body;\n\n    if (!story || story.trim().length < 10) {\n      return NextResponse.json(\n        { success: false, error: 'Story is too short' },\n        { status: 400 }\n      );\n    }\n\n    const validStyles: SongStyle[] = ['sad', 'savage', 'healing', 'vibe', 'meme'];\n    if (!validStyles.includes(style)) {\n      return NextResponse.json(\n        { success: false, error: 'Invalid style selected' },\n        { status: 400 }\n      );\n    }\n\n    console.log('Step 1: Generating song prompt with OpenRouter...');\n    \n    let promptResult;\n    try {\n      const openRouterClient = createOpenRouterClient();\n      promptResult = await openRouterClient.generateSongPrompt({\n        extractedText: story,\n        style,\n      });\n      \n      if (!promptResult.prompt || promptResult.prompt.length < 20) {\n        throw new Error('Generated lyrics are too short');\n      }\n      \n      console.log('Step 2: Prompt generated:', promptResult.title);\n    } catch (promptError) {\n      console.error('OpenRouter prompt generation failed:', promptError);\n      \n      promptResult = {\n        title: `${style.charAt(0).toUpperCase() + style.slice(1)} HeartHeal Song`,\n        tags: `${style}, emotional, heartbreak, healing`,\n        prompt: `A ${style} song about heartbreak, emotional healing, and moving forward.\\n${story.substring(0, 200)}`,\n      };\n      \n      console.log('Using fallback prompt template');\n    }\n\n    let previewUrl = '';\n    let fullUrl = '';\n    let lyrics = promptResult.prompt;\n    let duration = 30;\n\n    const sunoClient = createSunoClient();\n    \n    try {\n      console.log('Step 3: Generating music with Suno AI...');\n      \n      const musicResult = await sunoClient.generateSong({\n        prompt: promptResult.prompt,\n        title: promptResult.title,\n        tags: promptResult.tags,\n        style,\n      });\n\n      previewUrl = musicResult.audioUrl;\n      fullUrl = musicResult.videoUrl || musicResult.audioUrl;\n      duration = musicResult.duration || 60;\n      \n      if (musicResult.lyrics && musicResult.lyrics.length > lyrics.length) {\n        lyrics = musicResult.lyrics;\n      }\n\n      console.log('Music generated successfully');\n    } catch (musicError) {\n      console.warn('Suno music generation failed, using placeholder:', musicError);\n      \n      previewUrl = '/audio/placeholder-preview.mp3';\n      fullUrl = '/audio/placeholder-full.mp3';\n      duration = 10;\n    }\n\n    const song = await prisma.song.create({\n      data: {\n        title: promptResult.title,\n        story,\n        style,\n        lyrics: lyrics,\n        genre: promptResult.tags,\n        mood: style,\n        previewUrl,\n        fullUrl,\n        isPurchased: false,\n      },\n    });\n\n    return NextResponse.json({\n      success: true,\n      songId: song.id,\n      title: promptResult.title,\n      lyrics: lyrics,\n      message: 'Song generated successfully',\n    });\n  } catch (error) {\n    console.error('Error generating song:', error);\n    return NextResponse.json(\n      {\n        success: false,\n        error: error instanceof Error ? error.message : 'Failed to generate song',\n      },\n      { status: 500 }\n    );\n  }\n}\n","size_bytes":3605},"README.md":{"content":"# üíî HeartHeal\n\nTransform your heartbreak into healing songs. A Next.js web application that generates personalized AI songs with emotional healing features, multiple moods, and social sharing.\n\n## Features\n\n- üéµ **AI-Powered Song Generation**: Create unique breakup songs from your story\n- üí≥ **Paddle Billing Integration**: Subscription tiers and single song purchases\n- üì± **Social Sharing**: Share on TikTok, Instagram, WhatsApp, and Twitter\n- üé® **Five Emotional Modes**: Sad, Savage, Healing, Vibe, or Meme\n- üéß **Audio Preview**: 10-second previews before purchase\n- üíé **Premium Features**: AI breakup advice and no-contact guidance\n- üì± **Mobile-First Design**: Responsive and beautiful on all devices\n\n## Tech Stack\n\n- **Framework**: Next.js 16 with App Router\n- **Styling**: Tailwind CSS with custom heartbreak theme\n- **Animations**: Framer Motion for smooth transitions\n- **Payments**: Paddle Billing for subscriptions and one-time purchases\n- **Audio**: React-H5-Audio-Player for playback\n- **Icons**: React Icons\n\n## Getting Started\n\n### Prerequisites\n\n- Node.js 20 or higher\n- npm or yarn\n\n### Installation\n\n1. Clone the repository\n2. Install dependencies:\n   \\`\\`\\`bash\n   npm install\n   \\`\\`\\`\n\n3. Copy the environment variables:\n   \\`\\`\\`bash\n   cp .env.example .env\n   \\`\\`\\`\n\n4. Configure your environment variables:\n   - Get Paddle credentials from [Paddle Dashboard](https://vendors.paddle.com/)\n   - Get ElevenLabs API key from [ElevenLabs](https://elevenlabs.io/)\n\n### Development\n\nRun the development server:\n\n\\`\\`\\`bash\nnpm run dev\n\\`\\`\\`\n\nOpen [http://localhost:5000](http://localhost:5000) in your browser.\n\n## Paddle Integration\n\nThis app uses Paddle Billing for payments. To set up:\n\n1. **Sandbox Mode** (for testing):\n   - Set \\`NEXT_PUBLIC_PADDLE_ENVIRONMENT=sandbox\\`\n   - Use sandbox credentials from Paddle Dashboard\n\n2. **Create Products & Prices** in Paddle Dashboard:\n   - Standard Plan: $9/month (5 songs)\n   - Premium Plan: $19/month (20 songs + advice)\n   - Single Song: $2.99 one-time\n\n3. **Webhook Setup**:\n   - Add webhook URL: \\`your-domain.com/api/webhook\\`\n   - Copy the webhook secret to \\`.env\\`\n\n## ElevenLabs Music API Integration\n\nThe app is scaffolded for ElevenLabs Music API integration:\n\n1. Get your API key from [ElevenLabs](https://elevenlabs.io/)\n2. Add it to \\`.env\\` as \\`ELEVENLABS_API_KEY\\`\n3. Implement the song generation in \\`lib/elevenlabs.ts\\`\n4. Update the API route in \\`app/api/generate-song/route.ts\\`\n\n### Integration Points:\n\n\\`\\`\\`typescript\n// lib/elevenlabs.ts\nconst elevenlabs = new ElevenLabsMusicAPI(process.env.ELEVENLABS_API_KEY);\n\nconst song = await elevenlabs.generateSong({\n  prompt: userStory,\n  duration: 120, // 2 minutes\n  style: selectedStyle,\n});\n\\`\\`\\`\n\n## Project Structure\n\n\\`\\`\\`\n‚îú‚îÄ‚îÄ app/\n‚îÇ   ‚îú‚îÄ‚îÄ api/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generate-song/    # Song generation endpoint\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ song/[id]/         # Song retrieval endpoint\n‚îÇ   ‚îú‚îÄ‚îÄ story/                 # Story input page\n‚îÇ   ‚îú‚îÄ‚îÄ preview/               # Song preview page\n‚îÇ   ‚îú‚îÄ‚îÄ success/               # Payment success page\n‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx             # Root layout\n‚îÇ   ‚îú‚îÄ‚îÄ page.tsx               # Landing page\n‚îÇ   ‚îî‚îÄ‚îÄ globals.css            # Global styles\n‚îú‚îÄ‚îÄ components/\n‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx             # Navigation header\n‚îÇ   ‚îú‚îÄ‚îÄ Footer.tsx             # Site footer\n‚îÇ   ‚îú‚îÄ‚îÄ StyleSelector.tsx      # Song style picker\n‚îÇ   ‚îú‚îÄ‚îÄ SongPlayer.tsx         # Audio player\n‚îÇ   ‚îú‚îÄ‚îÄ SubscriptionCTA.tsx    # Pricing/checkout\n‚îÇ   ‚îú‚îÄ‚îÄ LoadingAnimation.tsx   # Loading states\n‚îÇ   ‚îú‚îÄ‚îÄ SocialShareButtons.tsx # Share functionality\n‚îÇ   ‚îî‚îÄ‚îÄ PaddleLoader.tsx       # Paddle.js loader\n‚îú‚îÄ‚îÄ lib/\n‚îÇ   ‚îî‚îÄ‚îÄ elevenlabs.ts          # ElevenLabs API client\n‚îî‚îÄ‚îÄ public/\n    ‚îî‚îÄ‚îÄ audio/                 # Audio files\n\\`\\`\\`\n\n## Subscription Tiers\n\n### Free\n- 10-second song previews\n- All song styles\n- Share previews\n\n### Standard ($9/month)\n- 5 full songs per month\n- HD audio quality\n- Download MP3 files\n- Social sharing\n\n### Premium ($19/month)\n- 20 full songs per month\n- HD audio quality\n- Download MP3 files\n- Social sharing\n- AI breakup advice\n- No-contact tips & guidance\n- Priority support\n\n## Deployment\n\nThis app is ready to deploy to Vercel:\n\n1. Push to GitHub\n2. Import to Vercel\n3. Add environment variables\n4. Deploy\n\nRemember to:\n- Switch Paddle to production mode\n- Update webhook URLs to production domain\n- Test the full payment flow\n\n## License\n\nMIT\n\n## Support\n\nFor issues or questions, please open a GitHub issue or contact support.\n\n---\n\nMade with üíî and AI\n# Breakup-music\n","size_bytes":4714},"components/SocialShareButtons.tsx":{"content":"\"use client\";\n\nimport { FaTiktok, FaInstagram, FaWhatsapp, FaTwitter, FaLink } from \"react-icons/fa\";\nimport { motion } from \"framer-motion\";\nimport { useState } from \"react\";\n\ninterface SocialShareButtonsProps {\n  songId?: string;\n  songTitle?: string;\n  url?: string;\n  title?: string;\n  message?: string;\n}\n\nexport function SocialShareButtons({ songId, songTitle, url, title, message }: SocialShareButtonsProps) {\n  const [copied, setCopied] = useState(false);\n  \n  const shareUrl = url || (typeof window !== \"undefined\" && songId\n    ? `${window.location.origin}/share/${songId}`\n    : \"\");\n  \n  const shareText = message || `Check out my AI-generated HeartHeal song: \"${title || songTitle}\" üíîüéµ`;\n\n  const handleTikTok = () => {\n    const tiktokUrl = `https://www.tiktok.com/upload?caption=${encodeURIComponent(shareText + \" \" + shareUrl)}`;\n    window.open(tiktokUrl, \"_blank\");\n  };\n\n  const handleInstagram = () => {\n    window.open(\"https://www.instagram.com/\", \"_blank\");\n    navigator.clipboard.writeText(shareUrl);\n  };\n\n  const handleWhatsApp = () => {\n    const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(shareText + \" \" + shareUrl)}`;\n    window.open(whatsappUrl, \"_blank\");\n  };\n\n  const handleTwitter = () => {\n    const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}`;\n    window.open(twitterUrl, \"_blank\");\n  };\n\n  const handleCopyLink = async () => {\n    try {\n      await navigator.clipboard.writeText(shareUrl);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      console.error(\"Failed to copy:\", err);\n    }\n  };\n\n  const socialButtons = [\n    {\n      name: \"TikTok\",\n      icon: FaTiktok,\n      onClick: handleTikTok,\n      color: \"bg-black hover:bg-gray-800\",\n    },\n    {\n      name: \"Instagram\",\n      icon: FaInstagram,\n      onClick: handleInstagram,\n      color: \"bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 hover:opacity-90\",\n    },\n    {\n      name: \"WhatsApp\",\n      icon: FaWhatsapp,\n      onClick: handleWhatsApp,\n      color: \"bg-green-500 hover:bg-green-600\",\n    },\n    {\n      name: \"Twitter\",\n      icon: FaTwitter,\n      onClick: handleTwitter,\n      color: \"bg-blue-400 hover:bg-blue-500\",\n    },\n  ];\n\n  return (\n    <div className=\"space-y-4\">\n      <h3 className=\"font-semibold text-lg text-gray-700\">Share Your Song</h3>\n      \n      <div className=\"flex flex-wrap gap-3\">\n        {socialButtons.map((button) => {\n          const Icon = button.icon;\n          return (\n            <motion.button\n              key={button.name}\n              whileHover={{ scale: 1.05 }}\n              whileTap={{ scale: 0.95 }}\n              onClick={button.onClick}\n              className={`${button.color} text-white px-6 py-3 rounded-full flex items-center space-x-2 shadow-lg transition-all duration-300`}\n            >\n              <Icon className=\"text-xl\" />\n              <span className=\"font-medium\">{button.name}</span>\n            </motion.button>\n          );\n        })}\n        \n        <motion.button\n          whileHover={{ scale: 1.05 }}\n          whileTap={{ scale: 0.95 }}\n          onClick={handleCopyLink}\n          className=\"bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-3 rounded-full flex items-center space-x-2 shadow-lg transition-all duration-300\"\n        >\n          <FaLink className=\"text-xl\" />\n          <span className=\"font-medium\">{copied ? \"Copied!\" : \"Copy Link\"}</span>\n        </motion.button>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3557},"app/api/song/[id]/route.ts":{"content":"import { NextRequest, NextResponse } from \"next/server\";\nimport { prisma } from \"@/lib/prisma\";\n\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: { id: string } }\n) {\n  try {\n    const songId = params.id;\n    \n    const song = await prisma.song.findUnique({\n      where: { id: songId },\n    });\n\n    if (!song) {\n      return NextResponse.json(\n        { success: false, error: \"Song not found\" },\n        { status: 404 }\n      );\n    }\n\n    return NextResponse.json({\n      success: true,\n      song: {\n        id: song.id,\n        title: song.title,\n        story: song.story,\n        style: song.style,\n        previewUrl: song.previewUrl,\n        fullUrl: song.isPurchased ? song.fullUrl : song.previewUrl,\n        isPurchased: song.isPurchased,\n        createdAt: song.createdAt,\n      },\n    });\n  } catch (error) {\n    console.error(\"Error fetching song:\", error);\n    return NextResponse.json(\n      { success: false, error: \"Failed to fetch song\" },\n      { status: 500 }\n    );\n  }\n}\n","size_bytes":1020},"app/globals.css":{"content":"@import \"tailwindcss\";\n\nhtml {\n  scroll-behavior: smooth;\n}\n\nbody {\n  color: #111827;\n  font-feature-settings: \"liga\" 1;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.btn-primary {\n  padding: 1rem 2rem;\n  background: linear-gradient(to right, #f43f5e, #e11d48);\n  color: white;\n  font-weight: 600;\n  border-radius: 9999px;\n  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);\n  transform-origin: center;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.btn-primary:hover {\n  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);\n  transform: scale(1.05);\n}\n\n.btn-secondary {\n  padding: 0.75rem 1.5rem;\n  background: white;\n  color: #e11d48;\n  font-weight: 600;\n  border-radius: 9999px;\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n  border: 2px solid #fecdd3;\n  transition: all 0.3s;\n}\n\n.btn-secondary:hover {\n  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);\n  border-color: #fda4af;\n  transform: scale(1.05);\n}\n\n.card {\n  background: white;\n  border-radius: 1.5rem;\n  box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.08);\n  padding: 2rem;\n  border: 1px solid rgba(0, 0, 0, 0.05);\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.card:hover {\n  box-shadow: 0 20px 50px -10px rgba(0, 0, 0, 0.12);\n  transform: translateY(-2px);\n}\n\n.input-field {\n  width: 100%;\n  padding: 0.75rem 1rem;\n  border: 2px solid #e5e7eb;\n  border-radius: 1rem;\n  outline: none;\n  transition: all 0.2s;\n}\n\n.input-field:focus {\n  border-color: #fda4af;\n  box-shadow: 0 0 0 4px rgba(254, 205, 211, 0.3);\n}\n\n.section-container {\n  max-width: 72rem;\n  margin: 0 auto;\n  padding: 4rem 1.5rem;\n}\n\n@media (min-width: 640px) {\n  .section-container {\n    padding: 5rem 2rem;\n  }\n}\n\n@media (min-width: 1024px) {\n  .section-container {\n    padding: 6rem 2.5rem;\n  }\n}\n\n.text-gradient {\n  background: linear-gradient(to right, #be123c, #fda4af);\n  background-clip: text;\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n}\n\n.glass-effect {\n  background: rgba(255, 255, 255, 0.6);\n  backdrop-filter: blur(16px);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.glass-effect-soft {\n  background: rgba(255, 255, 255, 0.8);\n  backdrop-filter: blur(12px);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n}\n\n.text-gradient-soft {\n  background: linear-gradient(to right, #fb7185, #fda4af);\n  background-clip: text;\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n}\n\n@keyframes heartbeat {\n  0%, 100% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(1.1);\n  }\n}\n\n.animate-heartbeat {\n  animation: heartbeat 1.5s ease-in-out infinite;\n}\n\n@keyframes note-float {\n  0% {\n    transform: translateY(0) rotate(0deg);\n    opacity: 1;\n  }\n  100% {\n    transform: translateY(-100px) rotate(360deg);\n    opacity: 0;\n  }\n}\n\n.animate-note-float {\n  animation: note-float 4s ease-in-out infinite;\n}\n","size_bytes":2884},"app/success/page.tsx":{"content":"\"use client\";\n\nimport { motion } from \"framer-motion\";\nimport Link from \"next/link\";\nimport { FaCheckCircle, FaDownload, FaMusic } from \"react-icons/fa\";\nimport { Header } from \"@/components/Header\";\nimport { Footer } from \"@/components/Footer\";\n\nexport default function SuccessPage() {\n  return (\n    <div className=\"min-h-screen\">\n      <Header />\n      \n      <main className=\"pt-32 pb-20\">\n        <div className=\"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <motion.div\n            initial={{ opacity: 0, scale: 0.9 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ duration: 0.6 }}\n            className=\"text-center space-y-8\"\n          >\n            <motion.div\n              initial={{ scale: 0 }}\n              animate={{ scale: 1 }}\n              transition={{ delay: 0.2, type: \"spring\", stiffness: 200 }}\n            >\n              <FaCheckCircle className=\"text-8xl text-green-500 mx-auto\" />\n            </motion.div>\n\n            <div className=\"space-y-4\">\n              <h1 className=\"text-4xl md:text-5xl font-bold text-gray-900\">\n                Payment Successful! üéâ\n              </h1>\n              <p className=\"text-xl text-gray-600\">\n                Thank you for your purchase. Your full song is now unlocked!\n              </p>\n            </div>\n\n            <div className=\"card space-y-6\">\n              <div className=\"flex items-center justify-center space-x-4\">\n                <FaMusic className=\"text-4xl text-heartbreak-500\" />\n                <div className=\"text-left\">\n                  <h3 className=\"font-bold text-lg text-gray-900\">What's Next?</h3>\n                  <p className=\"text-gray-600\">Your song is ready to download and share</p>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <Link href=\"/preview\">\n                  <motion.button\n                    whileHover={{ scale: 1.05 }}\n                    whileTap={{ scale: 0.95 }}\n                    className=\"btn-primary w-full flex items-center justify-center space-x-2\"\n                  >\n                    <FaDownload />\n                    <span>Download Song</span>\n                  </motion.button>\n                </Link>\n                \n                <Link href=\"/story\">\n                  <motion.button\n                    whileHover={{ scale: 1.05 }}\n                    whileTap={{ scale: 0.95 }}\n                    className=\"btn-secondary w-full flex items-center justify-center space-x-2\"\n                  >\n                    <FaMusic />\n                    <span>Create Another</span>\n                  </motion.button>\n                </Link>\n              </div>\n            </div>\n\n            <div className=\"card bg-heartbreak-50 border-heartbreak-200\">\n              <h3 className=\"font-semibold text-gray-900 mb-2\">\n                Receipt & Account Info\n              </h3>\n              <p className=\"text-sm text-gray-600\">\n                A receipt has been sent to your email. You can manage your subscription \n                and downloads from your account dashboard.\n              </p>\n            </div>\n          </motion.div>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":3262},"components/PaddleLoader.tsx":{"content":"\"use client\";\n\nimport Script from \"next/script\";\n\nexport function PaddleLoader() {\n  const handleLoad = () => {\n    if (typeof window !== \"undefined\" && (window as any).Paddle) {\n      const clientToken = process.env.NEXT_PUBLIC_PADDLE_CLIENT_TOKEN;\n      const environment = process.env.NEXT_PUBLIC_PADDLE_ENVIRONMENT === \"production\" ? \"production\" : \"sandbox\";\n\n      if (!clientToken) {\n        console.warn(\"Paddle client token not found. Payment functionality will not work.\");\n        return;\n      }\n\n      try {\n        (window as any).Paddle.Initialize({\n          token: clientToken,\n          environment: environment,\n        });\n        console.log(`Paddle initialized successfully in ${environment} mode`);\n      } catch (error) {\n        console.error(\"Failed to initialize Paddle:\", error);\n      }\n    }\n  };\n\n  const handleError = () => {\n    console.error(\"Failed to load Paddle SDK\");\n  };\n\n  return (\n    <Script\n      src=\"https://cdn.paddle.com/paddle/v2/paddle.js\"\n      strategy=\"afterInteractive\"\n      onLoad={handleLoad}\n      onError={handleError}\n    />\n  );\n}\n","size_bytes":1092},"prisma.config.ts":{"content":"import { defineConfig, env } from \"prisma/config\";\n\nexport default defineConfig({\n  schema: \"prisma/schema.prisma\",\n  migrations: {\n    path: \"prisma/migrations\",\n  },\n  engine: \"classic\",\n  datasource: {\n    url: env(\"DATABASE_URL\"),\n  },\n});\n","size_bytes":244},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nconst config: Config = {\n  content: [\n    \"./pages/**/*.{js,ts,jsx,tsx,mdx}\",\n    \"./components/**/*.{js,ts,jsx,tsx,mdx}\",\n    \"./app/**/*.{js,ts,jsx,tsx,mdx}\",\n  ],\n  theme: {\n    extend: {\n      colors: {\n        heartbreak: {\n          50: \"#fff1f2\",\n          100: \"#ffe4e6\",\n          200: \"#fecdd3\",\n          300: \"#fda4af\",\n          400: \"#fb7185\",\n          500: \"#f43f5e\",\n          600: \"#e11d48\",\n          700: \"#be123c\",\n          800: \"#9f1239\",\n          900: \"#881337\",\n        },\n        healing: {\n          50: \"#f0fdf4\",\n          100: \"#dcfce7\",\n          200: \"#bbf7d0\",\n          300: \"#86efac\",\n          400: \"#4ade80\",\n          500: \"#22c55e\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-inter)\", \"system-ui\", \"sans-serif\"],\n        display: [\"var(--font-clash)\", \"system-ui\", \"sans-serif\"],\n      },\n      animation: {\n        \"float\": \"float 3s ease-in-out infinite\",\n        \"pulse-slow\": \"pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite\",\n        \"spin-slow\": \"spin 8s linear infinite\",\n        \"bounce-slow\": \"bounce 3s infinite\",\n      },\n      keyframes: {\n        float: {\n          \"0%, 100%\": { transform: \"translateY(0px)\" },\n          \"50%\": { transform: \"translateY(-20px)\" },\n        },\n      },\n    },\n  },\n  plugins: [],\n};\n\nexport default config;\n","size_bytes":1359},"lib/elevenlabs.ts":{"content":"import axios from 'axios';\n\nexport type MusicStyle = 'sad' | 'savage' | 'healing' | 'vibe' | 'meme';\n\nexport interface MusicGenerationParams {\n  prompt: string;\n  title: string;\n  style: MusicStyle;\n  duration?: number;\n}\n\nexport interface GeneratedMusic {\n  audioUrl: string;\n  songId: string;\n  duration: number;\n}\n\nconst styleDescriptors: Record<MusicStyle, string> = {\n  sad: 'melancholic, slow tempo, emotional piano and strings, heartbreak ballad',\n  savage: 'confident, upbeat, strong bass, empowering pop with attitude',\n  healing: 'uplifting, hopeful, warm acoustic guitar, inspirational indie pop',\n  vibe: 'chill, lo-fi, laid-back R&B beats, modern bedroom pop',\n  meme: 'comedic, quirky, playful synths, viral TikTok comedy song',\n};\n\nexport class ElevenLabsMusicAPI {\n  private apiKey: string;\n  private baseUrl = 'https://api.elevenlabs.io/v1';\n\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n  }\n\n  async generateSong(params: MusicGenerationParams): Promise<GeneratedMusic> {\n    if (!this.apiKey || this.apiKey === 'your_elevenlabs_api_key_here') {\n      throw new Error('ElevenLabs API key not configured');\n    }\n\n    const fullPrompt = `${params.prompt}. Musical style: ${styleDescriptors[params.style]}`;\n\n    try {\n      const response = await axios.post(\n        `${this.baseUrl}/text-to-sound-effects`,\n        {\n          text: fullPrompt,\n          duration_seconds: params.duration || 30,\n          prompt_influence: 0.8,\n        },\n        {\n          headers: {\n            'xi-api-key': this.apiKey,\n            'Content-Type': 'application/json',\n          },\n          responseType: 'arraybuffer',\n        }\n      );\n\n      const audioBase64 = Buffer.from(response.data).toString('base64');\n      const audioUrl = `data:audio/mpeg;base64,${audioBase64}`;\n\n      return {\n        audioUrl,\n        songId: `song_${Date.now()}`,\n        duration: params.duration || 30,\n      };\n    } catch (error: any) {\n      console.error('ElevenLabs API Error:', error.response?.data || error.message);\n      \n      if (error.response?.status === 401) {\n        throw new Error('Invalid ElevenLabs API key. Please check your configuration.');\n      }\n      \n      if (error.response?.status === 429) {\n        throw new Error('ElevenLabs API rate limit exceeded. Please try again later.');\n      }\n\n      throw new Error(\n        'Failed to generate music with ElevenLabs. Using fallback placeholder audio.'\n      );\n    }\n  }\n}\n\nexport function createElevenLabsClient(): ElevenLabsMusicAPI {\n  const apiKey = process.env.ELEVENLABS_API_KEY || '';\n  return new ElevenLabsMusicAPI(apiKey);\n}\n","size_bytes":2619},"components/Footer.tsx":{"content":"\"use client\";\n\nimport Link from \"next/link\";\nimport { FaTiktok, FaInstagram, FaTwitter, FaHeart } from \"react-icons/fa\";\n\nexport function Footer() {\n  return (\n    <footer className=\"bg-gradient-to-br from-gray-900 to-heartbreak-900 text-white mt-20\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8 mb-8\">\n          <div>\n            <div className=\"flex items-center space-x-2 mb-4\">\n              <FaHeart className=\"text-heartbreak-400 text-xl\" />\n              <span className=\"text-lg font-bold\">HeartHeal</span>\n            </div>\n            <p className=\"text-gray-400 text-sm\">\n              Transform your heartbreak into healing songs. Express what you feel with AI-powered music.\n            </p>\n          </div>\n          \n          <div>\n            <h3 className=\"font-semibold mb-4\">Product</h3>\n            <ul className=\"space-y-2 text-sm text-gray-400\">\n              <li>\n                <Link href=\"/#pricing\" className=\"hover:text-heartbreak-300 transition-colors\">\n                  Pricing\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/#how-it-works\" className=\"hover:text-heartbreak-300 transition-colors\">\n                  How It Works\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/story\" className=\"hover:text-heartbreak-300 transition-colors\">\n                  Create Song\n                </Link>\n              </li>\n            </ul>\n          </div>\n          \n          <div>\n            <h3 className=\"font-semibold mb-4\">About</h3>\n            <ul className=\"space-y-2 text-sm text-gray-400\">\n              <li>\n                <Link href=\"/#about-ai\" className=\"hover:text-heartbreak-300 transition-colors\">\n                  About AI\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/#faq\" className=\"hover:text-heartbreak-300 transition-colors\">\n                  FAQ\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/privacy\" className=\"hover:text-heartbreak-300 transition-colors\">\n                  Privacy Policy\n                </Link>\n              </li>\n            </ul>\n          </div>\n          \n          <div>\n            <h3 className=\"font-semibold mb-4\">Follow Us</h3>\n            <div className=\"flex space-x-4\">\n              <a\n                href=\"https://tiktok.com\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-gray-400 hover:text-heartbreak-300 transition-colors\"\n              >\n                <FaTiktok className=\"text-2xl\" />\n              </a>\n              <a\n                href=\"https://instagram.com\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-gray-400 hover:text-heartbreak-300 transition-colors\"\n              >\n                <FaInstagram className=\"text-2xl\" />\n              </a>\n              <a\n                href=\"https://twitter.com\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-gray-400 hover:text-heartbreak-300 transition-colors\"\n              >\n                <FaTwitter className=\"text-2xl\" />\n              </a>\n            </div>\n          </div>\n        </div>\n        \n        <div className=\"border-t border-gray-800 pt-8 text-center text-sm text-gray-400\">\n          <p>&copy; 2025 HeartHeal. All rights reserved. Made with üíî and AI.</p>\n        </div>\n      </div>\n    </footer>\n  );\n}\n","size_bytes":3632},"components/Header.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport Link from \"next/link\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { FaHeart, FaBars, FaTimes } from \"react-icons/fa\";\n\nexport function Header() {\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n\n  return (\n    <motion.header\n      initial={{ y: -100, opacity: 0 }}\n      animate={{ y: 0, opacity: 1 }}\n      transition={{ duration: 0.6 }}\n      className=\"fixed top-0 left-0 right-0 z-50 glass-effect-soft border-b border-rose-100\"\n    >\n      <nav className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\n        <div className=\"flex items-center justify-between\">\n          <Link href=\"/\" className=\"flex items-center space-x-2 group\">\n            <motion.div\n              whileHover={{ scale: 1.1, rotate: 5 }}\n              className=\"text-rose-400\"\n            >\n              <FaHeart className=\"text-2xl animate-heartbeat\" />\n            </motion.div>\n            <span className=\"text-xl font-bold text-gradient-soft\">\n              HeartHeal\n            </span>\n          </Link>\n          \n          {/* Desktop Navigation */}\n          <div className=\"hidden md:flex items-center space-x-6\">\n            <Link\n              href=\"/pricing\"\n              className=\"text-gray-600 hover:text-rose-500 transition-colors duration-200 font-medium\"\n            >\n              Pricing\n            </Link>\n            <Link\n              href=\"/#faq\"\n              className=\"text-gray-600 hover:text-rose-500 transition-colors duration-200 font-medium\"\n            >\n              FAQ\n            </Link>\n            <Link href=\"/story\">\n              <button className=\"bg-gradient-to-r from-rose-400 to-pink-400 hover:from-rose-500 hover:to-pink-500 text-white px-6 py-2 rounded-full font-medium transition-all duration-200 shadow-md hover:shadow-lg\">\n                Get Started\n              </button>\n            </Link>\n          </div>\n\n          {/* Mobile Menu Button */}\n          <button\n            onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n            className=\"md:hidden text-gray-600 hover:text-rose-500 transition-colors\"\n            aria-label=\"Toggle menu\"\n          >\n            {mobileMenuOpen ? <FaTimes className=\"text-2xl\" /> : <FaBars className=\"text-2xl\" />}\n          </button>\n        </div>\n\n        {/* Mobile Navigation */}\n        <AnimatePresence>\n          {mobileMenuOpen && (\n            <motion.div\n              initial={{ opacity: 0, height: 0 }}\n              animate={{ opacity: 1, height: \"auto\" }}\n              exit={{ opacity: 0, height: 0 }}\n              transition={{ duration: 0.2 }}\n              className=\"md:hidden mt-4 pb-4 space-y-4\"\n            >\n              <Link\n                href=\"/pricing\"\n                onClick={() => setMobileMenuOpen(false)}\n                className=\"block text-gray-600 hover:text-rose-500 transition-colors duration-200 font-medium py-2\"\n              >\n                Pricing\n              </Link>\n              <Link\n                href=\"/#faq\"\n                onClick={() => setMobileMenuOpen(false)}\n                className=\"block text-gray-600 hover:text-rose-500 transition-colors duration-200 font-medium py-2\"\n              >\n                FAQ\n              </Link>\n              <Link href=\"/story\" onClick={() => setMobileMenuOpen(false)}>\n                <button className=\"w-full bg-gradient-to-r from-rose-400 to-pink-400 hover:from-rose-500 hover:to-pink-500 text-white px-6 py-2 rounded-full font-medium transition-all duration-200 shadow-md hover:shadow-lg\">\n                  Get Started\n                </button>\n              </Link>\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </nav>\n    </motion.header>\n  );\n}\n","size_bytes":3764},"lib/prisma.ts":{"content":"import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n","size_bytes":284},"app/story/page.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { useRouter } from \"next/navigation\";\nimport { Header } from \"@/components/Header\";\nimport { Footer } from \"@/components/Footer\";\nimport { StyleSelector, SongStyle } from \"@/components/StyleSelector\";\nimport FileUpload from \"@/components/FileUpload\";\nimport LoadingProgress, { LoadingStep } from \"@/components/LoadingProgress\";\nimport { FiEdit, FiImage } from \"react-icons/fi\";\n\ntype InputMode = 'text' | 'screenshot';\n\nexport default function StoryPage() {\n  const router = useRouter();\n  const [inputMode, setInputMode] = useState<InputMode>('text');\n  const [story, setStory] = useState(\"\");\n  const [screenshot, setScreenshot] = useState<File | null>(null);\n  const [style, setStyle] = useState<SongStyle>(\"sad\");\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [loadingStep, setLoadingStep] = useState<LoadingStep>('ocr');\n  const [loadingProgress, setLoadingProgress] = useState(0);\n\n  const handleGenerate = async () => {\n    if (inputMode === 'text' && story.trim().length < 10) {\n      alert(\"Please tell us a bit more about your breakup (at least 10 characters)\");\n      return;\n    }\n\n    if (inputMode === 'screenshot' && !screenshot) {\n      alert(\"Please upload a chat screenshot first\");\n      return;\n    }\n\n    setIsGenerating(true);\n    setLoadingStep('ocr');\n    setLoadingProgress(0);\n\n    try {\n      let extractedText = story;\n\n      if (inputMode === 'screenshot' && screenshot) {\n        setLoadingStep('ocr');\n        \n        const formData = new FormData();\n        formData.append('image', screenshot);\n\n        const ocrResponse = await fetch('/api/ocr', {\n          method: 'POST',\n          body: formData,\n        });\n\n        const ocrData = await ocrResponse.json();\n\n        if (!ocrData.success) {\n          throw new Error(ocrData.error || 'Failed to extract text from screenshot');\n        }\n\n        extractedText = ocrData.cleanedText;\n      }\n\n      setLoadingStep('lyrics');\n      setLoadingProgress(30);\n\n      const response = await fetch(\"/api/generate-song\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          story: extractedText,\n          style,\n        }),\n      });\n\n      const data = await response.json();\n\n      if (data.success) {\n        setLoadingStep('complete');\n        setLoadingProgress(100);\n        \n        setTimeout(() => {\n          router.push(`/preview?songId=${data.songId}`);\n        }, 500);\n      } else {\n        throw new Error(data.error || \"Failed to generate song\");\n      }\n    } catch (error) {\n      console.error(\"Error generating song:\", error);\n      alert(`Something went wrong: ${error instanceof Error ? error.message : 'Unknown error'}. Please try again.`);\n      setIsGenerating(false);\n    }\n  };\n\n  if (isGenerating) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50 px-4\">\n        <LoadingProgress currentStep={loadingStep} progress={loadingProgress} />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen\">\n      <Header />\n      \n      <main className=\"pt-32 pb-20\">\n        <div className=\"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n            className=\"space-y-8\"\n          >\n            <div className=\"text-center space-y-4\">\n              <h1 className=\"text-4xl md:text-5xl font-bold text-gray-900\">\n                Tell Your <span className=\"text-gradient\">Breakup Story</span>\n              </h1>\n              <p className=\"text-xl text-gray-600\">\n                Write your story or upload a chat screenshot\n              </p>\n            </div>\n\n            <div className=\"card space-y-6\">\n              <div className=\"flex gap-4 border-b border-gray-200\">\n                <button\n                  onClick={() => setInputMode('text')}\n                  className={`\n                    flex items-center gap-2 px-6 py-3 font-semibold transition-all border-b-2\n                    ${inputMode === 'text'\n                      ? 'border-rose-500 text-rose-500'\n                      : 'border-transparent text-gray-500 hover:text-gray-700'\n                    }\n                  `}\n                >\n                  <FiEdit className=\"w-5 h-5\" />\n                  Write Story\n                </button>\n                <button\n                  onClick={() => setInputMode('screenshot')}\n                  className={`\n                    flex items-center gap-2 px-6 py-3 font-semibold transition-all border-b-2\n                    ${inputMode === 'screenshot'\n                      ? 'border-rose-500 text-rose-500'\n                      : 'border-transparent text-gray-500 hover:text-gray-700'\n                    }\n                  `}\n                >\n                  <FiImage className=\"w-5 h-5\" />\n                  Upload Screenshot\n                </button>\n              </div>\n\n              {inputMode === 'text' ? (\n                <div className=\"space-y-3\">\n                  <label htmlFor=\"story\" className=\"block text-lg font-semibold text-gray-700\">\n                    Your Story\n                  </label>\n                  <textarea\n                    id=\"story\"\n                    rows={6}\n                    value={story}\n                    onChange={(e) => setStory(e.target.value)}\n                    placeholder=\"Example: They said they needed space, then I saw them with someone new the next day. After 3 years together, I deserved better than that...\"\n                    className=\"input-field resize-none\"\n                    maxLength={500}\n                  />\n                  <div className=\"flex justify-between text-sm text-gray-500\">\n                    <span>Be honest. The AI can handle it.</span>\n                    <span>{story.length}/500</span>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"space-y-3\">\n                  <label className=\"block text-lg font-semibold text-gray-700\">\n                    Upload Chat Screenshot\n                  </label>\n                  <FileUpload\n                    onFileSelect={(file) => setScreenshot(file)}\n                    onClear={() => setScreenshot(null)}\n                  />\n                  <p className=\"text-sm text-gray-500\">\n                    We'll extract the conversation using AI and create your song\n                  </p>\n                </div>\n              )}\n\n              <StyleSelector selected={style} onChange={setStyle} />\n\n              <motion.button\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                onClick={handleGenerate}\n                disabled={inputMode === 'text' ? story.trim().length < 10 : !screenshot}\n                className=\"btn-primary w-full text-xl py-5 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                Generate My Song üéµ\n              </motion.button>\n            </div>\n\n            <div className=\"card bg-heartbreak-50 border-heartbreak-200\">\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"text-2xl\">üí°</div>\n                <div>\n                  <h3 className=\"font-semibold text-gray-900 mb-2\">Pro Tips:</h3>\n                  <ul className=\"space-y-1 text-sm text-gray-600\">\n                    <li>‚Ä¢ Be specific about what hurt the most</li>\n                    <li>‚Ä¢ Include details that made your relationship unique</li>\n                    <li>‚Ä¢ Don't worry about grammar - raw emotion works best</li>\n                    <li>‚Ä¢ The more honest you are, the better your song will be</li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n          </motion.div>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":8053},"app/share/[id]/opengraph-image.tsx":{"content":"import { ImageResponse } from 'next/og';\n\nexport const runtime = 'edge';\n\nexport const alt = 'HeartHeal';\nexport const size = {\n  width: 1200,\n  height: 630,\n};\n\nexport const contentType = 'image/png';\n\nexport default async function Image({ params }: { params: { id: string } }) {\n  return new ImageResponse(\n    (\n      <div\n        style={{\n          height: '100%',\n          width: '100%',\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          background: 'linear-gradient(135deg, #fff1f2 0%, #ffffff 50%, #f3f4f6 100%)',\n        }}\n      >\n        <div\n          style={{\n            display: 'flex',\n            fontSize: 120,\n            marginBottom: 40,\n          }}\n        >\n          üíîüéµ\n        </div>\n        <div\n          style={{\n            fontSize: 60,\n            fontWeight: 'bold',\n            background: 'linear-gradient(90deg, #be123c 0%, #fda4af 100%)',\n            backgroundClip: 'text',\n            color: 'transparent',\n            marginBottom: 20,\n          }}\n        >\n          HeartHeal\n        </div>\n        <div\n          style={{\n            fontSize: 30,\n            color: '#6b7280',\n          }}\n        >\n          Turn your pain into songs that heal\n        </div>\n      </div>\n    ),\n    {\n      ...size,\n    }\n  );\n}\n","size_bytes":1356},"app/layout.tsx":{"content":"import type { Metadata } from \"next\";\nimport { Inter } from \"next/font/google\";\nimport \"./globals.css\";\nimport { PaddleLoader } from \"@/components/PaddleLoader\";\n\nconst inter = Inter({ subsets: [\"latin\"], variable: \"--font-inter\" });\n\nexport const metadata: Metadata = {\n  title: \"üíî HeartHeal - Turn Your Pain Into Songs That Heal\",\n  description: \"Instant AI songs that say what you wish you could ‚Äî sad, savage, healing, or funny. Transform your heartbreak into music in seconds.\",\n  keywords: [\"breakup\", \"healing\", \"AI music\", \"heartbreak\", \"emotional healing\", \"sad songs\", \"savage songs\"],\n  openGraph: {\n    title: \"üíî HeartHeal - Heartbroken? Turn your pain into a song that heals\",\n    description: \"Instant AI songs tailored to your emotions\",\n    type: \"website\",\n  },\n};\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  return (\n    <html lang=\"en\" className={inter.variable}>\n      <body className=\"antialiased bg-gradient-to-br from-heartbreak-50 via-white to-gray-50 min-h-screen\">\n        <PaddleLoader />\n        {children}\n      </body>\n    </html>\n  );\n}\n","size_bytes":1123},"app/page.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport Link from \"next/link\";\nimport { FaHeart, FaMusic, FaArrowRight, FaTimes } from \"react-icons/fa\";\nimport { Header } from \"@/components/Header\";\nimport { Footer } from \"@/components/Footer\";\n\nexport default function HomePage() {\n  const [showOnboarding, setShowOnboarding] = useState(false);\n  const [onboardingStep, setOnboardingStep] = useState(1);\n  const [selectedFeeling, setSelectedFeeling] = useState(\"\");\n  const [userStory, setUserStory] = useState(\"\");\n  const [selectedMode, setSelectedMode] = useState(\"\");\n\n  const feelings = [\n    { label: \"Heartbroken\", emoji: \"üíî\", value: \"heartbroken\" },\n    { label: \"Angry / Savage\", emoji: \"üò§\", value: \"savage\" },\n    { label: \"Healing\", emoji: \"üå±\", value: \"healing\" },\n    { label: \"Missing Them\", emoji: \"üò¢\", value: \"missing\" },\n    { label: \"I Just Need a Laugh\", emoji: \"üòÇ\", value: \"meme\" },\n  ];\n\n  const modes = [\n    { \n      name: \"Sad\", \n      emoji: \"üò¢\", \n      description: \"Let it all out. Songs that understand your pain.\",\n      example: \"Why wasn't I enough?\",\n      style: \"sad\",\n      gradient: \"from-blue-500 to-purple-500\"\n    },\n    { \n      name: \"Savage\", \n      emoji: \"üî•\", \n      description: \"Channel that anger. Empowering revenge anthems.\",\n      example: \"Your loss, my glow-up\",\n      style: \"savage\",\n      gradient: \"from-red-500 to-pink-500\"\n    },\n    { \n      name: \"Healing\", \n      emoji: \"üå±\", \n      description: \"Move forward. Hopeful songs about growth.\",\n      example: \"I'm better without you\",\n      style: \"healing\",\n      gradient: \"from-green-500 to-teal-500\"\n    },\n    { \n      name: \"Vibe\", \n      emoji: \"‚ú®\", \n      description: \"Just vibing. Chill, atmospheric tracks.\",\n      example: \"It is what it is\",\n      style: \"vibe\",\n      gradient: \"from-purple-500 to-indigo-500\"\n    },\n    { \n      name: \"Meme\", \n      emoji: \"üòÇ\", \n      description: \"Laugh it off. Funny, quirky healing songs.\",\n      example: \"Red flags? I collected them all\",\n      style: \"meme\",\n      gradient: \"from-yellow-500 to-orange-500\"\n    },\n  ];\n\n  const handleCreateSong = () => {\n    if (onboardingStep === 3 && selectedMode) {\n      window.location.href = `/story?feeling=${selectedFeeling}&mode=${selectedMode}&story=${encodeURIComponent(userStory)}`;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen\">\n      <Header />\n      \n      <main className=\"pt-24\">\n        {/* Hero Section */}\n        <section className=\"section-container\">\n          <div className=\"max-w-5xl mx-auto text-center space-y-8\">\n            <motion.h1\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.8 }}\n              className=\"text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-bold leading-tight px-4\"\n            >\n              <span className=\"text-gradient\">Heartbroken?</span>\n              <br />\n              <span className=\"text-gradient\">Turn your pain into</span>\n              <br />\n              <span className=\"text-gradient\">a song that heals. üíî</span>\n            </motion.h1>\n            \n            <motion.p\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.8, delay: 0.2 }}\n              className=\"text-lg sm:text-xl md:text-2xl text-gray-600 max-w-3xl mx-auto px-4\"\n            >\n              Instant AI songs that say what you wish you could ‚Äî sad, savage, healing, or funny.\n            </motion.p>\n            \n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.8, delay: 0.4 }}\n              className=\"space-y-4\"\n            >\n              <motion.button\n                whileHover={{ scale: 1.05 }}\n                whileTap={{ scale: 0.95 }}\n                onClick={() => setShowOnboarding(true)}\n                className=\"btn-primary flex items-center space-x-2 mx-auto text-lg px-10 py-5\"\n              >\n                <span>Create My Song</span>\n                <FaArrowRight />\n              </motion.button>\n              \n              <p className=\"text-sm text-gray-500\">\n                Takes 10 seconds. No account needed.\n              </p>\n            </motion.div>\n          </div>\n        </section>\n\n        {/* Emotional Hook Section */}\n        <section className=\"section-container bg-white/50\">\n          <div className=\"max-w-4xl mx-auto text-center space-y-12\">\n            <div className=\"space-y-4\">\n              <h2 className=\"text-3xl md:text-4xl font-bold text-gray-900\">\n                Why This Helps\n              </h2>\n              <p className=\"text-lg md:text-xl text-gray-600 leading-relaxed max-w-3xl mx-auto\">\n                Breakups hurt. Overthinking hurts. Missing someone hurts.<br />\n                HeartHeal gives you emotional release ‚Äî a personalized soundtrack for your situation.\n              </p>\n            </div>\n\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              {modes.map((mode, index) => (\n                <motion.div\n                  key={mode.name}\n                  initial={{ opacity: 0, y: 20 }}\n                  whileInView={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.5, delay: index * 0.1 }}\n                  viewport={{ once: true }}\n                  className={`card text-center hover:shadow-xl transition-all duration-300 bg-gradient-to-br ${mode.gradient} text-white cursor-pointer`}\n                >\n                  <div className=\"text-5xl mb-3\">{mode.emoji}</div>\n                  <h3 className=\"text-lg font-bold\">{mode.name}</h3>\n                </motion.div>\n              ))}\n            </div>\n          </div>\n        </section>\n\n        {/* Social Proof Section */}\n        <section className=\"section-container\">\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.5 }}\n              viewport={{ once: true }}\n              className=\"card text-center\"\n            >\n              <div className=\"text-4xl font-bold text-heartbreak-600 mb-2\">17,000+</div>\n              <p className=\"text-gray-600\">Songs generated this week</p>\n            </motion.div>\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.5, delay: 0.1 }}\n              viewport={{ once: true }}\n              className=\"card text-center\"\n            >\n              <div className=\"text-4xl font-bold text-heartbreak-600 mb-2\">40+</div>\n              <p className=\"text-gray-600\">Countries sharing their songs</p>\n            </motion.div>\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.5, delay: 0.2 }}\n              viewport={{ once: true }}\n              className=\"card text-center\"\n            >\n              <div className=\"text-4xl font-bold text-heartbreak-600 mb-2\">90%</div>\n              <p className=\"text-gray-600\">Feel better after their first song</p>\n            </motion.div>\n          </div>\n        </section>\n\n        {/* How It Works Section */}\n        <section id=\"how-it-works\" className=\"section-container bg-white/50\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-4xl md:text-5xl font-bold text-gray-900 mb-4\">\n              How It Works\n            </h2>\n            <p className=\"text-xl text-gray-600\">\n              Four simple steps to emotional release\n            </p>\n          </div>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\n            {[\n              {\n                step: \"1\",\n                title: \"Tell us your vibe\",\n                description: \"Share your story or skip it entirely. Your choice.\",\n                icon: \"üí≠\",\n              },\n              {\n                step: \"2\",\n                title: \"Choose your mode\",\n                description: \"Sad, Savage, Healing, Vibe, or Meme.\",\n                icon: \"üé®\",\n              },\n              {\n                step: \"3\",\n                title: \"Get your song\",\n                description: \"AI creates a personal song + lyrics just for you.\",\n                icon: \"üéµ\",\n              },\n              {\n                step: \"4\",\n                title: \"Download or share\",\n                description: \"Keep it private or share it everywhere.\",\n                icon: \"üì≤\",\n              },\n            ].map((item, index) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, y: 20 }}\n                whileInView={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.5, delay: index * 0.1 }}\n                viewport={{ once: true }}\n                className=\"card text-center\"\n              >\n                <div className=\"text-6xl mb-4\">{item.icon}</div>\n                <div className=\"text-sm font-bold text-heartbreak-500 mb-2\">\n                  STEP {item.step}\n                </div>\n                <h3 className=\"text-xl font-bold text-gray-900 mb-3\">\n                  {item.title}\n                </h3>\n                <p className=\"text-gray-600\">{item.description}</p>\n              </motion.div>\n            ))}\n          </div>\n        </section>\n\n        {/* Benefits Section */}\n        <section className=\"section-container\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-4xl md:text-5xl font-bold text-gray-900 mb-4\">\n              Get What You Need\n            </h2>\n            <p className=\"text-xl text-gray-600\">\n              Actual outcomes, not just features\n            </p>\n          </div>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\n            {[\n              {\n                icon: \"üß†\",\n                title: \"Stop overthinking\",\n                description: \"Express your feelings through music instead of spiraling.\",\n              },\n              {\n                icon: \"üö´\",\n                title: \"Get closure without texting\",\n                description: \"Say what you need to say without contacting your ex.\",\n              },\n              {\n                icon: \"üòÇ\",\n                title: \"Laugh again\",\n                description: \"Turn your pain into something you can smile about.\",\n              },\n              {\n                icon: \"üé®\",\n                title: \"Turn pain into creativity\",\n                description: \"Your heartbreak becomes art you actually want to keep.\",\n              },\n            ].map((benefit, index) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, y: 20 }}\n                whileInView={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.5, delay: index * 0.1 }}\n                viewport={{ once: true }}\n                className=\"card text-center hover:shadow-xl transition-shadow duration-300\"\n              >\n                <div className=\"text-5xl mb-4\">{benefit.icon}</div>\n                <h3 className=\"text-xl font-bold text-gray-900 mb-3\">\n                  {benefit.title}\n                </h3>\n                <p className=\"text-gray-600\">{benefit.description}</p>\n              </motion.div>\n            ))}\n          </div>\n        </section>\n\n        {/* Pricing Teaser Section */}\n        <section className=\"section-container bg-gradient-to-br from-heartbreak-50 to-purple-50\">\n          <div className=\"card max-w-3xl mx-auto text-center\">\n            <h2 className=\"text-3xl md:text-4xl font-bold text-gray-900 mb-6\">\n              Your First Song is Free\n            </h2>\n            <p className=\"text-lg text-gray-600 mb-8\">\n              Premium gives you unlimited songs + fast generation. No commitment needed ‚Äî start healing now.\n            </p>\n            <Link href=\"/pricing\">\n              <motion.button\n                whileHover={{ scale: 1.05 }}\n                whileTap={{ scale: 0.95 }}\n                className=\"text-heartbreak-600 hover:text-heartbreak-700 font-semibold text-lg underline\"\n              >\n                See pricing details ‚Üí\n              </motion.button>\n            </Link>\n          </div>\n        </section>\n\n        {/* Final CTA Section */}\n        <section className=\"section-container\">\n          <div className=\"bg-gradient-to-r from-heartbreak-500 to-heartbreak-600 text-white rounded-3xl p-12 text-center space-y-8\">\n            <h2 className=\"text-4xl md:text-5xl font-bold\">\n              Ready to Feel Better?\n            </h2>\n            <p className=\"text-xl opacity-90 max-w-2xl mx-auto\">\n              Join thousands turning their heartbreak into something beautiful\n            </p>\n            <motion.button\n              whileHover={{ scale: 1.05 }}\n              whileTap={{ scale: 0.95 }}\n              onClick={() => setShowOnboarding(true)}\n              className=\"bg-white text-heartbreak-600 px-10 py-5 rounded-full font-bold text-lg shadow-2xl hover:shadow-3xl transition-all duration-300\"\n            >\n              Create My Song Now\n            </motion.button>\n          </div>\n        </section>\n      </main>\n\n      <Footer />\n\n      {/* Onboarding Modal */}\n      <AnimatePresence>\n        {showOnboarding && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\"\n            onClick={() => setShowOnboarding(false)}\n          >\n            <motion.div\n              initial={{ scale: 0.9, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              exit={{ scale: 0.9, opacity: 0 }}\n              className=\"bg-white rounded-3xl p-6 sm:p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto relative shadow-2xl\"\n              onClick={(e) => e.stopPropagation()}\n            >\n              <button\n                onClick={() => setShowOnboarding(false)}\n                className=\"absolute top-6 right-6 text-gray-400 hover:text-gray-600 transition-colors\"\n              >\n                <FaTimes className=\"text-2xl\" />\n              </button>\n\n              {/* Step 1: Emotional Check-in */}\n              {onboardingStep === 1 && (\n                <motion.div\n                  initial={{ opacity: 0, x: -20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  exit={{ opacity: 0, x: -20 }}\n                  transition={{ duration: 0.3 }}\n                  className=\"space-y-6\"\n                >\n                  <div className=\"text-center mb-8\">\n                    <motion.h2\n                      initial={{ opacity: 0, y: -10 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ delay: 0.1 }}\n                      className=\"text-2xl sm:text-3xl font-bold text-gray-900 mb-2\"\n                    >\n                      How are you feeling right now?\n                    </motion.h2>\n                    <motion.p\n                      initial={{ opacity: 0 }}\n                      animate={{ opacity: 1 }}\n                      transition={{ delay: 0.2 }}\n                      className=\"text-gray-600\"\n                    >\n                      This helps us create the perfect song for you\n                    </motion.p>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 gap-4\">\n                    {feelings.map((feeling, index) => (\n                      <motion.button\n                        key={feeling.value}\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ delay: 0.1 * index, duration: 0.3 }}\n                        whileHover={{ scale: 1.02, x: 4 }}\n                        whileTap={{ scale: 0.98 }}\n                        onClick={() => {\n                          setSelectedFeeling(feeling.value);\n                          setOnboardingStep(2);\n                        }}\n                        className=\"card hover:shadow-xl transition-all duration-300 flex items-center space-x-3 sm:space-x-4 text-left p-4 sm:p-6 cursor-pointer hover:border-heartbreak-300\"\n                      >\n                        <motion.span\n                          className=\"text-3xl sm:text-4xl\"\n                          whileHover={{ rotate: [0, -10, 10, 0] }}\n                          transition={{ duration: 0.5 }}\n                        >\n                          {feeling.emoji}\n                        </motion.span>\n                        <span className=\"text-lg sm:text-xl font-semibold text-gray-900\">{feeling.label}</span>\n                      </motion.button>\n                    ))}\n                  </div>\n                </motion.div>\n              )}\n\n              {/* Step 2: Optional Story Input */}\n              {onboardingStep === 2 && (\n                <motion.div\n                  initial={{ opacity: 0, x: 20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  exit={{ opacity: 0, x: -20 }}\n                  transition={{ duration: 0.3 }}\n                  className=\"space-y-6\"\n                >\n                  <div className=\"text-center mb-8\">\n                    <motion.h2\n                      initial={{ opacity: 0, y: -10 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ delay: 0.1 }}\n                      className=\"text-2xl sm:text-3xl font-bold text-gray-900 mb-2\"\n                    >\n                      Tell us your story\n                    </motion.h2>\n                    <motion.p\n                      initial={{ opacity: 0 }}\n                      animate={{ opacity: 1 }}\n                      transition={{ delay: 0.2 }}\n                      className=\"text-gray-600\"\n                    >\n                      Or skip this step ‚Äî it's totally optional\n                    </motion.p>\n                  </div>\n\n                  <div className=\"relative\">\n                    <motion.textarea\n                      initial={{ opacity: 0, y: 10 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ delay: 0.3 }}\n                      value={userStory}\n                      onChange={(e) => {\n                        if (e.target.value.length <= 500) {\n                          setUserStory(e.target.value);\n                        }\n                      }}\n                      maxLength={500}\n                      placeholder=\"What happened? How do you feel? What do you wish you could say?\"\n                      className=\"w-full h-40 p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-heartbreak-500 focus:border-transparent resize-none transition-all duration-300\"\n                    />\n                    <div className=\"absolute bottom-3 right-3 text-sm text-gray-500\">\n                      {userStory.length}/500\n                    </div>\n                  </div>\n\n                  <motion.div\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    transition={{ delay: 0.4 }}\n                    className=\"flex flex-col sm:flex-row gap-4\"\n                  >\n                    <motion.button\n                      onClick={() => setOnboardingStep(3)}\n                      whileHover={{ scale: 1.05 }}\n                      whileTap={{ scale: 0.95 }}\n                      className=\"btn-secondary flex-1\"\n                    >\n                      Skip\n                    </motion.button>\n                    <motion.button\n                      onClick={() => setOnboardingStep(3)}\n                      whileHover={{ scale: 1.05 }}\n                      whileTap={{ scale: 0.95 }}\n                      className=\"btn-primary flex-1\"\n                    >\n                      Continue\n                    </motion.button>\n                  </motion.div>\n\n                  <motion.button\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    transition={{ delay: 0.5 }}\n                    onClick={() => setOnboardingStep(1)}\n                    className=\"text-gray-500 hover:text-gray-700 text-sm w-full text-center transition-colors\"\n                  >\n                    ‚Üê Back\n                  </motion.button>\n                </motion.div>\n              )}\n\n              {/* Step 3: Choose Mode */}\n              {onboardingStep === 3 && (\n                <motion.div\n                  initial={{ opacity: 0, x: 20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  exit={{ opacity: 0, x: -20 }}\n                  transition={{ duration: 0.3 }}\n                  className=\"space-y-6\"\n                >\n                  <div className=\"text-center mb-8\">\n                    <motion.h2\n                      initial={{ opacity: 0, y: -10 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ delay: 0.1 }}\n                      className=\"text-2xl sm:text-3xl font-bold text-gray-900 mb-2\"\n                    >\n                      Choose your mode\n                    </motion.h2>\n                    <motion.p\n                      initial={{ opacity: 0 }}\n                      animate={{ opacity: 1 }}\n                      transition={{ delay: 0.2 }}\n                      className=\"text-gray-600\"\n                    >\n                      What kind of song matches your mood?\n                    </motion.p>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 gap-4\">\n                    {modes.map((mode, index) => (\n                      <motion.button\n                        key={mode.style}\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ delay: 0.1 * index, duration: 0.3 }}\n                        whileHover={{ scale: 1.02, y: -2 }}\n                        whileTap={{ scale: 0.98 }}\n                        onClick={() => setSelectedMode(mode.style)}\n                        className={`card text-left p-4 sm:p-6 transition-all duration-300 cursor-pointer relative overflow-hidden ${\n                          selectedMode === mode.style\n                            ? 'ring-4 ring-heartbreak-500 shadow-2xl bg-heartbreak-50'\n                            : 'hover:shadow-xl hover:border-heartbreak-300'\n                        }`}\n                      >\n                        {selectedMode === mode.style && (\n                          <motion.div\n                            layoutId=\"selectedMode\"\n                            className=\"absolute inset-0 bg-gradient-to-r from-heartbreak-100/50 to-transparent\"\n                            initial={false}\n                            transition={{ type: \"spring\", stiffness: 300, damping: 30 }}\n                          />\n                        )}\n                        <div className=\"flex items-start space-x-3 sm:space-x-4 relative z-10\">\n                          <motion.span\n                            className=\"text-4xl sm:text-5xl\"\n                            animate={selectedMode === mode.style ? { scale: [1, 1.2, 1] } : {}}\n                            transition={{ duration: 0.3 }}\n                          >\n                            {mode.emoji}\n                          </motion.span>\n                          <div className=\"flex-1\">\n                            <h3 className=\"text-xl sm:text-2xl font-bold text-gray-900 mb-2\">{mode.name}</h3>\n                            <p className=\"text-sm sm:text-base text-gray-600 mb-1\">{mode.description}</p>\n                            <p className=\"text-xs sm:text-sm text-gray-500 italic\">\"{mode.example}\"</p>\n                          </div>\n                          {selectedMode === mode.style && (\n                            <motion.div\n                              initial={{ scale: 0 }}\n                              animate={{ scale: 1 }}\n                              className=\"flex-shrink-0 w-6 h-6 bg-heartbreak-500 rounded-full flex items-center justify-center\"\n                            >\n                              <svg className=\"w-4 h-4 text-white\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={3} d=\"M5 13l4 4L19 7\" />\n                              </svg>\n                            </motion.div>\n                          )}\n                        </div>\n                      </motion.button>\n                    ))}\n                  </div>\n\n                  <motion.div\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    transition={{ delay: 0.5 }}\n                    className=\"flex flex-col sm:flex-row gap-4\"\n                  >\n                    <button\n                      onClick={() => setOnboardingStep(2)}\n                      className=\"btn-secondary flex-1\"\n                    >\n                      ‚Üê Back\n                    </button>\n                    <motion.button\n                      onClick={handleCreateSong}\n                      disabled={!selectedMode}\n                      whileHover={selectedMode ? { scale: 1.05 } : {}}\n                      whileTap={selectedMode ? { scale: 0.95 } : {}}\n                      className={`btn-primary flex-1 ${!selectedMode ? 'opacity-50 cursor-not-allowed' : ''}`}\n                    >\n                      Generate My Song\n                    </motion.button>\n                  </motion.div>\n                </motion.div>\n              )}\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n","size_bytes":26240},"components/LoadingAnimation.tsx":{"content":"\"use client\";\n\nimport { motion } from \"framer-motion\";\nimport { FaMusic, FaHeart } from \"react-icons/fa\";\n\ninterface LoadingAnimationProps {\n  message?: string;\n}\n\nexport function LoadingAnimation({ message = \"Creating your song...\" }: LoadingAnimationProps) {\n  return (\n    <div className=\"flex flex-col items-center justify-center space-y-8 py-12\">\n      <div className=\"relative\">\n        <motion.div\n          animate={{\n            scale: [1, 1.2, 1],\n            rotate: [0, 180, 360],\n          }}\n          transition={{\n            duration: 2,\n            repeat: Infinity,\n            ease: \"easeInOut\",\n          }}\n          className=\"text-heartbreak-500\"\n        >\n          <FaHeart className=\"text-6xl\" />\n        </motion.div>\n        \n        <motion.div\n          animate={{\n            y: [-20, -40, -20],\n            x: [10, 30, 10],\n            opacity: [0, 1, 0],\n          }}\n          transition={{\n            duration: 2,\n            repeat: Infinity,\n            delay: 0.2,\n          }}\n          className=\"absolute -top-4 -right-4 text-heartbreak-400\"\n        >\n          <FaMusic className=\"text-2xl\" />\n        </motion.div>\n        \n        <motion.div\n          animate={{\n            y: [-20, -40, -20],\n            x: [-10, -30, -10],\n            opacity: [0, 1, 0],\n          }}\n          transition={{\n            duration: 2,\n            repeat: Infinity,\n            delay: 0.4,\n          }}\n          className=\"absolute -top-4 -left-4 text-heartbreak-400\"\n        >\n          <FaMusic className=\"text-2xl\" />\n        </motion.div>\n        \n        <motion.div\n          animate={{\n            y: [20, 40, 20],\n            x: [10, 30, 10],\n            opacity: [0, 1, 0],\n          }}\n          transition={{\n            duration: 2,\n            repeat: Infinity,\n            delay: 0.6,\n          }}\n          className=\"absolute -bottom-4 -right-4 text-heartbreak-400\"\n        >\n          <FaMusic className=\"text-2xl\" />\n        </motion.div>\n      </div>\n      \n      <div className=\"text-center space-y-2\">\n        <motion.p\n          animate={{ opacity: [0.5, 1, 0.5] }}\n          transition={{ duration: 2, repeat: Infinity }}\n          className=\"text-xl font-semibold text-gray-700\"\n        >\n          {message}\n        </motion.p>\n        <p className=\"text-sm text-gray-500\">\n          Turning your heartbreak into art ‚ú®\n        </p>\n      </div>\n      \n      <div className=\"flex space-x-2\">\n        {[0, 1, 2].map((i) => (\n          <motion.div\n            key={i}\n            animate={{\n              scale: [1, 1.5, 1],\n              backgroundColor: [\"#f43f5e\", \"#fb7185\", \"#f43f5e\"],\n            }}\n            transition={{\n              duration: 1,\n              repeat: Infinity,\n              delay: i * 0.2,\n            }}\n            className=\"w-3 h-3 rounded-full bg-heartbreak-500\"\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n","size_bytes":2912},"components/SubscriptionCTA.tsx":{"content":"\"use client\";\n\nimport { motion } from \"framer-motion\";\nimport { FaCheck, FaStar, FaCrown } from \"react-icons/fa\";\nimport { useState } from \"react\";\n\ninterface SubscriptionTier {\n  id: string;\n  name: string;\n  price: number;\n  interval: string;\n  features: string[];\n  popular?: boolean;\n  icon: any;\n  priceId: string;\n}\n\nconst tiers: SubscriptionTier[] = [\n  {\n    id: \"standard\",\n    name: \"Standard\",\n    price: 9,\n    interval: \"month\",\n    priceId: process.env.NEXT_PUBLIC_PADDLE_PRICE_STANDARD || \"pri_standard\",\n    icon: FaStar,\n    features: [\n      \"5 full songs per month\",\n      \"All song styles (Sad, Savage, Healing)\",\n      \"HD audio quality\",\n      \"Social sharing\",\n      \"Download MP3 files\",\n    ],\n  },\n  {\n    id: \"premium\",\n    name: \"Premium\",\n    price: 19,\n    interval: \"month\",\n    priceId: process.env.NEXT_PUBLIC_PADDLE_PRICE_PREMIUM || \"pri_premium\",\n    icon: FaCrown,\n    popular: true,\n    features: [\n      \"20 full songs per month\",\n      \"All song styles (Sad, Savage, Healing)\",\n      \"HD audio quality\",\n      \"Social sharing\",\n      \"Download MP3 files\",\n      \"AI breakup advice\",\n      \"No-contact tips & guidance\",\n      \"Priority support\",\n      \"Early access to new features\",\n    ],\n  },\n];\n\nexport function SubscriptionCTA() {\n  const [isLoading, setIsLoading] = useState<string | null>(null);\n\n  const handleSubscribe = async (tier: SubscriptionTier) => {\n    setIsLoading(tier.id);\n    \n    try {\n      if (typeof window === \"undefined\") {\n        throw new Error(\"Window is not defined\");\n      }\n\n      if (!(window as any).Paddle) {\n        alert(\"Payment system is still loading. Please wait a moment and try again.\");\n        setIsLoading(null);\n        return;\n      }\n\n      if (!tier.priceId) {\n        console.error(\"Paddle price ID not configured. Please set up your Paddle products and environment variables.\");\n        alert(\"Payment system not configured. Please contact support.\");\n        setIsLoading(null);\n        return;\n      }\n\n      const isPaddleFormat = /^pri_[0-9a-zA-Z]{20,}$/.test(tier.priceId);\n      if (!isPaddleFormat) {\n        console.warn(`Price ID \"${tier.priceId}\" doesn't match Paddle format. Expected format: pri_01... (alphanumeric, 20+ chars). Configure real Paddle price IDs in environment variables.`);\n        alert(\"Payment system not fully configured. Please set up real Paddle price IDs.\");\n        setIsLoading(null);\n        return;\n      }\n\n      (window as any).Paddle.Checkout.open({\n        items: [\n          {\n            priceId: tier.priceId,\n            quantity: 1,\n          },\n        ],\n        settings: {\n          successUrl: `${window.location.origin}/success?tier=${tier.id}`,\n          theme: \"light\",\n        },\n      });\n    } catch (error) {\n      console.error(\"Checkout error:\", error);\n      alert(\"Unable to open checkout. Please try again or contact support.\");\n    } finally {\n      setIsLoading(null);\n    }\n  };\n\n  const handleSingleSongPurchase = () => {\n    setIsLoading(\"single\");\n    \n    try {\n      if (typeof window === \"undefined\") {\n        throw new Error(\"Window is not defined\");\n      }\n\n      if (!(window as any).Paddle) {\n        alert(\"Payment system is still loading. Please wait a moment and try again.\");\n        setIsLoading(null);\n        return;\n      }\n\n      const singlePriceId = process.env.NEXT_PUBLIC_PADDLE_PRICE_SINGLE;\n      \n      if (!singlePriceId) {\n        console.error(\"Paddle price ID for single purchase not configured. Please set up your Paddle products.\");\n        alert(\"Payment system not configured. Please contact support.\");\n        setIsLoading(null);\n        return;\n      }\n\n      const isPaddleFormat = /^pri_[0-9a-zA-Z]{20,}$/.test(singlePriceId);\n      if (!isPaddleFormat) {\n        console.warn(`Price ID \"${singlePriceId}\" doesn't match Paddle format. Expected format: pri_01... (alphanumeric, 20+ chars). Configure real Paddle price IDs in environment variables.`);\n        alert(\"Payment system not fully configured. Please set up real Paddle price IDs.\");\n        setIsLoading(null);\n        return;\n      }\n\n      (window as any).Paddle.Checkout.open({\n        items: [\n          {\n            priceId: singlePriceId,\n            quantity: 1,\n          },\n        ],\n        settings: {\n          successUrl: `${window.location.origin}/success?type=single`,\n          theme: \"light\",\n        },\n      });\n    } catch (error) {\n      console.error(\"Checkout error:\", error);\n      alert(\"Unable to open checkout. Please try again or contact support.\");\n    } finally {\n      setIsLoading(null);\n    }\n  };\n\n  return (\n    <div className=\"space-y-8\">\n      <div className=\"text-center space-y-2\">\n        <h2 className=\"text-3xl md:text-4xl font-bold text-gray-900\">\n          Unlock Full Songs\n        </h2>\n        <p className=\"text-gray-600 text-lg\">\n          Choose the plan that fits your heartbreak journey\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-5xl mx-auto\">\n        {tiers.map((tier) => {\n          const Icon = tier.icon;\n          const isPopular = tier.popular;\n          \n          return (\n            <motion.div\n              key={tier.id}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.5 }}\n              className={`relative rounded-3xl p-8 ${\n                isPopular\n                  ? \"bg-gradient-to-br from-heartbreak-500 to-heartbreak-600 text-white shadow-2xl border-4 border-heartbreak-400 transform scale-105\"\n                  : \"bg-white border-2 border-gray-200 shadow-lg\"\n              }`}\n            >\n              {isPopular && (\n                <div className=\"absolute -top-4 left-1/2 transform -translate-x-1/2\">\n                  <span className=\"bg-yellow-400 text-yellow-900 px-4 py-1 rounded-full text-sm font-bold shadow-lg\">\n                    Most Popular\n                  </span>\n                </div>\n              )}\n\n              <div className=\"flex items-center space-x-3 mb-4\">\n                <div className={`p-3 rounded-full ${isPopular ? \"bg-white/20\" : \"bg-heartbreak-100\"}`}>\n                  <Icon className={`text-2xl ${isPopular ? \"text-white\" : \"text-heartbreak-500\"}`} />\n                </div>\n                <h3 className={`text-2xl font-bold ${isPopular ? \"text-white\" : \"text-gray-900\"}`}>\n                  {tier.name}\n                </h3>\n              </div>\n\n              <div className=\"mb-6\">\n                <div className=\"flex items-baseline\">\n                  <span className={`text-5xl font-bold ${isPopular ? \"text-white\" : \"text-gray-900\"}`}>\n                    ${tier.price}\n                  </span>\n                  <span className={`ml-2 ${isPopular ? \"text-white/80\" : \"text-gray-500\"}`}>\n                    /{tier.interval}\n                  </span>\n                </div>\n              </div>\n\n              <ul className=\"space-y-3 mb-8\">\n                {tier.features.map((feature, index) => (\n                  <li key={index} className=\"flex items-start space-x-3\">\n                    <FaCheck className={`text-lg mt-0.5 flex-shrink-0 ${\n                      isPopular ? \"text-white\" : \"text-heartbreak-500\"\n                    }`} />\n                    <span className={isPopular ? \"text-white\" : \"text-gray-600\"}>\n                      {feature}\n                    </span>\n                  </li>\n                ))}\n              </ul>\n\n              <motion.button\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                onClick={() => handleSubscribe(tier)}\n                disabled={isLoading === tier.id}\n                className={`w-full py-4 rounded-full font-semibold text-lg shadow-lg transition-all duration-300 ${\n                  isPopular\n                    ? \"bg-white text-heartbreak-600 hover:shadow-xl\"\n                    : \"bg-gradient-to-r from-heartbreak-500 to-heartbreak-600 text-white hover:shadow-xl\"\n                }`}\n              >\n                {isLoading === tier.id ? \"Loading...\" : `Subscribe to ${tier.name}`}\n              </motion.button>\n            </motion.div>\n          );\n        })}\n      </div>\n\n      <div className=\"text-center pt-6 border-t border-gray-200\">\n        <p className=\"text-gray-600 mb-4\">Or buy just this one song</p>\n        <motion.button\n          whileHover={{ scale: 1.05 }}\n          whileTap={{ scale: 0.95 }}\n          onClick={handleSingleSongPurchase}\n          disabled={isLoading === \"single\"}\n          className=\"btn-secondary\"\n        >\n          {isLoading === \"single\" ? \"Loading...\" : \"Buy Single Song - $2.99\"}\n        </motion.button>\n      </div>\n    </div>\n  );\n}\n","size_bytes":8737},"replit.md":{"content":"# HeartHeal - Replit Project\n\n## Overview\nHeartHeal is a Next.js web application for generating personalized AI breakup songs with emotional healing support, multiple mood modes, and social sharing features. Built with Next.js 16, Tailwind CSS, Framer Motion, Suno AI, and OpenRouter. Rebranded from \"Breakup Song Generator\" to \"HeartHeal\" with a high-conversion landing page.\n\n## Recent Changes (November 15, 2025)\n\n### Latest Updates - Rebranding & Landing Page Redesign (November 15, 2025)\n- ‚úÖ **Rebranded to HeartHeal** - Updated all branding from \"Breakup Song Generator\" to \"HeartHeal\"\n- ‚úÖ **Redesigned landing page** - High-conversion design with emotional headlines, social proof, benefits-focused sections\n- ‚úÖ **Added onboarding modal** - Interactive 3-step wizard: emotional check-in ‚Üí story input ‚Üí mode selection\n- ‚úÖ **Updated AI model** - Changed from Claude 3.5 Sonnet to Mistral 7B Instruct (free tier)\n- ‚úÖ **Changed AI role** - AI now cleans up OCR text and generates Suno prompts instead of full lyrics\n- ‚úÖ **Added 5 emotional modes** - Sad, Savage, Healing, Vibe, and Meme (expanded from 3)\n\n### Previous Updates - Suno AI Integration & Animated Lyrics\n- ‚úÖ **Integrated Suno AI** - Replaced ElevenLabs with Suno AI for professional music generation\n- ‚úÖ **Added OpenRouter integration** - Using Mistral 7B for OCR cleanup and prompt generation\n- ‚úÖ **Created LyricsOverlay component** - Smooth scrolling lyrics synchronized with song playback\n- ‚úÖ **Created AnimatedBackground component** - Floating hearts, musical notes, and gradient animations\n- ‚úÖ **Enhanced Share page** - Two-column layout with lyrics overlay, animated background, and custom audio player\n- ‚úÖ **Enhanced Preview page** - Added lyrics display with animations and improved social sharing\n- ‚úÖ **Implemented OCR workflow** - Screenshot ‚Üí OCR ‚Üí LLM ‚Üí Suno AI complete pipeline\n\n### Previous Updates - Professional UI Redesign (November 14, 2025)\n- ‚úÖ **Redesigned landing page** - Removed excessive pricing, focus on value and features\n- ‚úÖ **Created dedicated pricing page** (`/pricing`) with comprehensive tier comparison\n- ‚úÖ **Enhanced UI design** - Improved spacing, typography, card hover effects\n- ‚úÖ **Improved Paddle integration** - Better error handling and environment validation\n- ‚úÖ **Updated navigation** - Added \"Get Started\" button and pricing link in header\n- ‚úÖ **Next.js optimization** - Added image optimization and compression settings\n\n### Initial Setup\n- ‚úÖ Initialized Next.js 16 project with App Router and TypeScript\n- ‚úÖ Configured Tailwind CSS with custom heartbreak color palette\n- ‚úÖ Created all core components (Header, Footer, StyleSelector, SongPlayer, SubscriptionCTA, LoadingAnimation, SocialShareButtons)\n- ‚úÖ Built landing page with animated broken heart and floating musical notes\n- ‚úÖ Created story input page with textarea and style selection (Sad, Savage, Healing)\n- ‚úÖ Built song preview page with audio player and subscription options\n- ‚úÖ Integrated Paddle.js for subscription checkout\n- ‚úÖ Added social share functionality for TikTok, Instagram, WhatsApp, Twitter\n- ‚úÖ Created API routes for song generation and retrieval\n- ‚úÖ Set up ElevenLabs Music API integration scaffolding\n\n## Project Architecture\n\n### Frontend\n- **Next.js 16 App Router**: Modern React framework with server components\n- **Tailwind CSS**: Utility-first styling with custom heartbreak theme\n- **Framer Motion**: Smooth animations and transitions\n- **React Icons**: Icon library for UI elements\n\n### Pages\n1. `/` - Landing page with hero, features, how it works, FAQ (pricing removed for cleaner UX)\n2. `/pricing` - Dedicated pricing page with all subscription tiers and FAQs\n3. `/story` - Story input with text/screenshot options and style selection\n4. `/preview` - Song preview with animated lyrics overlay, custom player, and social sharing\n5. `/share/[id]` - Public song share page with full animations and lyrics\n6. `/success` - Payment confirmation page\n\n### Components\n- `Header` - Navigation with logo and links\n- `Footer` - Links and social media\n- `StyleSelector` - Choose song vibe (Sad/Savage/Healing)\n- `SongPlayer` - Audio playback with controls\n- `LyricsOverlay` - Animated scrolling lyrics synchronized to music (NEW)\n- `AnimatedBackground` - Floating hearts, musical notes, gradient animations (NEW)\n- `SubscriptionCTA` - Pricing tiers and checkout\n- `LoadingAnimation` - Spinning musical notes animation\n- `LoadingProgress` - Progress indicator for song generation\n- `FileUpload` - Screenshot upload component\n- `SocialShareButtons` - Share to social platforms\n- `PaddleLoader` - Paddle.js SDK initialization\n\n### API Routes\n- `/api/generate-song` - POST endpoint for song generation (OpenRouter + Suno AI)\n- `/api/song/[id]` - GET endpoint for song retrieval\n- `/api/ocr` - POST endpoint for text extraction from screenshots\n- `/api/webhook` - Paddle webhook handler\n\n### Libraries\n- `lib/suno.ts` - Suno AI client for music generation (NEW)\n- `lib/openrouter.ts` - OpenRouter client for LLM prompt generation (NEW)\n- `lib/ocr.ts` - Tesseract.js OCR functionality\n- `lib/lyrics.ts` - Lyrics generation utilities\n- `lib/prisma.ts` - Prisma database client\n\n## Paddle Billing Integration\n\n### Subscription Tiers\n- **Free**: $0 - 10-second previews, unlimited generations\n- **Standard**: $9/month - 5 full songs, HD audio, MP3 downloads\n- **Premium**: $19/month - 20 full songs, AI advice, no-contact tips, priority support\n- **Single Song**: $2.99 - One-time purchase (optional alternative to subscriptions)\n\n### Setup Instructions\n\n1. **Create Paddle Account**\n   - Sign up at https://www.paddle.com/\n   - Complete account verification\n\n2. **Create Products in Paddle Dashboard**\n   - Create 3 subscription products (Standard, Premium, Single Song)\n   - Note the Price IDs for each product\n\n3. **Configure Environment Variables**\n   Add these to your Replit Secrets:\n   ```\n   NEXT_PUBLIC_PADDLE_CLIENT_TOKEN=your_client_token_here\n   NEXT_PUBLIC_PADDLE_ENVIRONMENT=sandbox (or \"production\")\n   NEXT_PUBLIC_PADDLE_PRICE_STANDARD=pri_01xxxxx (your actual price ID)\n   NEXT_PUBLIC_PADDLE_PRICE_PREMIUM=pri_01xxxxx (your actual price ID)\n   NEXT_PUBLIC_PADDLE_PRICE_SINGLE=pri_01xxxxx (your actual price ID)\n   PADDLE_API_KEY=your_api_key_here\n   PADDLE_NOTIFICATION_WEBHOOK_SECRET=pdl_ntfset_xxxxx\n   ```\n\n4. **Set up Webhook**\n   - In Paddle dashboard, go to Developer Tools > Webhooks\n   - Add webhook URL: `https://your-replit-url.repl.co/api/webhook`\n   - Select events: `transaction.completed`, `subscription.created`, `subscription.updated`, `subscription.canceled`\n\n5. **Test in Sandbox Mode**\n   - Use Paddle's test card numbers\n   - Verify webhook events are received\n   - Test subscription flows\n\n### Error Handling\nThe app includes comprehensive error handling for Paddle:\n- Validates environment variables before checkout\n- Provides user-friendly error messages\n- Logs errors to console for debugging\n- Prevents checkout with invalid price IDs\n\n## AI Integration\n\n### Suno AI Music Generation\nThe app uses Suno AI (via third-party API providers) for professional music generation:\n\n**Required Environment Variables:**\n```\nSUNO_API_KEY=your_api_key_here\n```\n\n**Integration Flow:**\n1. User provides breakup story (text or screenshot)\n2. OCR extracts text from screenshot (if applicable)\n3. OpenRouter/LLM generates song lyrics and metadata\n4. Suno AI generates the actual music\n5. Song is stored in database with preview and full URLs\n\n**Implementation:** See `lib/suno.ts` for the Suno API client\n\n### OpenRouter LLM Integration\nThe app uses OpenRouter to access Claude 3.5 Sonnet for intelligent prompt generation:\n\n**Required Environment Variables:**\n```\nOPENROUTER_API_KEY=your_api_key_here\n```\n\n**Purpose:**\n- Converts raw breakup stories into structured song lyrics\n- Generates song titles and genre/style tags\n- Optimizes prompts for Suno AI music generation\n\n**Implementation:** See `lib/openrouter.ts` for the OpenRouter API client\n\n### Tesseract.js OCR\nExtracts text from chat screenshots using client-side OCR:\n- Implementation: `lib/ocr.ts`\n- API endpoint: `/api/ocr`\n- No API key required (runs in-browser)\n\n## User Preferences\n- Mobile-first responsive design\n- Smooth animations using Framer Motion\n- Heartbreak color palette (pale red, white, gray)\n- Rounded, friendly fonts\n- No placeholder data - production-ready code\n\n## Dependencies\n```json\n{\n  \"@paddle/paddle-js\": \"^1.5.1\",\n  \"next\": \"^16.0.3\",\n  \"react\": \"^19.2.0\",\n  \"tailwindcss\": \"^4.1.17\",\n  \"framer-motion\": \"^12.23.24\",\n  \"react-icons\": \"^5.5.0\",\n  \"react-h5-audio-player\": \"^3.10.1\",\n  \"clsx\": \"^2.1.1\"\n}\n```\n\n## Development\n- Dev server runs on port 5000 (required for Replit webview)\n- All hosts allowed for iframe compatibility\n- TypeScript strict mode enabled\n\n## Complete Workflow\n\n### Song Generation Flow\n1. **User Input**: User enters breakup story as text OR uploads chat screenshot\n2. **OCR Processing** (if screenshot): Tesseract.js extracts text from image\n3. **LLM Generation**: OpenRouter (Claude 3.5) converts story into:\n   - Song title\n   - Genre/style tags\n   - Full lyrics (200-400 words)\n4. **Music Generation**: Suno AI creates the actual song (30-60 seconds)\n5. **Preview Display**: User sees:\n   - Animated lyrics overlay\n   - Custom audio player\n   - Animated background with floating elements\n   - Social share buttons\n6. **Sharing**: Users can share song on TikTok, Instagram, WhatsApp, Twitter\n\n### Technical Features\n- **Mobile-first responsive design** with Tailwind CSS\n- **Smooth animations** using Framer Motion\n- **Lyrics scrolling** synchronized to song duration (60s default)\n- **CSS-only animations** for background (no video generation)\n- **Export functionality** (premium feature - locked)\n- **AI Breakup Advice** (premium feature - upsell in UI)\n\n## Next Steps\n1. ‚úÖ Suno AI and OpenRouter integration complete\n2. Set up Paddle products and prices in dashboard\n3. Configure webhook endpoint for subscription events\n4. Test payment flow in sandbox mode\n5. Add user authentication for song history\n6. Implement download functionality for purchased songs\n7. Test complete OCR ‚Üí LLM ‚Üí Suno workflow with real API keys\n","size_bytes":10216},"components/FileUpload.tsx":{"content":"'use client';\n\nimport { useState, useRef } from 'react';\nimport { FiUpload, FiX, FiImage } from 'react-icons/fi';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface FileUploadProps {\n  onFileSelect: (file: File) => void;\n  onClear?: () => void;\n  acceptedFormats?: string;\n  maxSizeMB?: number;\n}\n\nexport default function FileUpload({\n  onFileSelect,\n  onClear,\n  acceptedFormats = 'image/*',\n  maxSizeMB = 10,\n}: FileUploadProps) {\n  const [isDragging, setIsDragging] = useState(false);\n  const [preview, setPreview] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleDragEnter = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(true);\n  };\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(false);\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  const validateFile = (file: File): boolean => {\n    setError(null);\n\n    if (!file.type.startsWith('image/')) {\n      setError('Please upload an image file');\n      return false;\n    }\n\n    const maxSizeBytes = maxSizeMB * 1024 * 1024;\n    if (file.size > maxSizeBytes) {\n      setError(`File size must be less than ${maxSizeMB}MB`);\n      return false;\n    }\n\n    return true;\n  };\n\n  const processFile = (file: File) => {\n    if (!validateFile(file)) return;\n\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      setPreview(e.target?.result as string);\n      onFileSelect(file);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsDragging(false);\n\n    const files = e.dataTransfer.files;\n    if (files && files.length > 0) {\n      processFile(files[0]);\n    }\n  };\n\n  const handleFileInput = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files;\n    if (files && files.length > 0) {\n      processFile(files[0]);\n    }\n  };\n\n  const handleClear = () => {\n    setPreview(null);\n    setError(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n    onClear?.();\n  };\n\n  const handleClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  return (\n    <div className=\"w-full\">\n      <AnimatePresence mode=\"wait\">\n        {!preview ? (\n          <motion.div\n            key=\"upload\"\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -10 }}\n            className={`\n              relative border-2 border-dashed rounded-xl p-8 md:p-12 text-center cursor-pointer\n              transition-all duration-300 bg-white hover:bg-gray-50\n              ${isDragging ? 'border-rose-400 bg-rose-50' : 'border-gray-300'}\n              ${error ? 'border-red-400' : ''}\n            `}\n            onDragEnter={handleDragEnter}\n            onDragLeave={handleDragLeave}\n            onDragOver={handleDragOver}\n            onDrop={handleDrop}\n            onClick={handleClick}\n          >\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept={acceptedFormats}\n              onChange={handleFileInput}\n              className=\"hidden\"\n            />\n\n            <motion.div\n              animate={isDragging ? { scale: 1.1 } : { scale: 1 }}\n              className=\"flex flex-col items-center gap-4\"\n            >\n              <div className=\"w-16 h-16 rounded-full bg-rose-100 flex items-center justify-center\">\n                <FiUpload className=\"w-8 h-8 text-rose-500\" />\n              </div>\n\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                  {isDragging ? 'Drop your screenshot here' : 'Upload Chat Screenshot'}\n                </h3>\n                <p className=\"text-gray-600 text-sm mb-1\">\n                  Drag & drop or click to browse\n                </p>\n                <p className=\"text-gray-500 text-xs\">\n                  Supports WhatsApp, iMessage, Instagram DMs (Max {maxSizeMB}MB)\n                </p>\n              </div>\n\n              <div className=\"flex items-center gap-2 text-xs text-gray-500\">\n                <FiImage className=\"w-4 h-4\" />\n                <span>PNG, JPG, JPEG, WebP</span>\n              </div>\n            </motion.div>\n          </motion.div>\n        ) : (\n          <motion.div\n            key=\"preview\"\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n            exit={{ opacity: 0, scale: 0.95 }}\n            className=\"relative\"\n          >\n            <div className=\"relative rounded-xl overflow-hidden border-2 border-gray-200 bg-white\">\n              <img\n                src={preview}\n                alt=\"Chat screenshot preview\"\n                className=\"w-full h-auto max-h-96 object-contain\"\n              />\n              \n              <button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  handleClear();\n                }}\n                className=\"absolute top-3 right-3 w-8 h-8 bg-rose-500 hover:bg-rose-600 text-white rounded-full flex items-center justify-center transition-colors shadow-lg\"\n                aria-label=\"Remove image\"\n              >\n                <FiX className=\"w-5 h-5\" />\n              </button>\n            </div>\n\n            <p className=\"text-center text-sm text-gray-600 mt-3\">\n              Screenshot uploaded successfully\n            </p>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {error && (\n        <motion.p\n          initial={{ opacity: 0, y: -10 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"text-red-500 text-sm mt-3 text-center\"\n        >\n          {error}\n        </motion.p>\n      )}\n    </div>\n  );\n}\n","size_bytes":5947},"components/LoadingProgress.tsx":{"content":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { FiMusic, FiImage, FiEdit, FiCheck } from 'react-icons/fi';\n\nexport type LoadingStep = 'ocr' | 'lyrics' | 'music' | 'complete';\n\ninterface LoadingProgressProps {\n  currentStep: LoadingStep;\n  progress?: number;\n}\n\nconst steps = [\n  {\n    id: 'ocr' as LoadingStep,\n    label: 'Extracting Text',\n    icon: FiImage,\n    description: 'Reading your chat screenshot...',\n  },\n  {\n    id: 'lyrics' as LoadingStep,\n    label: 'Writing Lyrics',\n    icon: FiEdit,\n    description: 'Crafting your breakup song...',\n  },\n  {\n    id: 'music' as LoadingStep,\n    label: 'Creating Music',\n    icon: FiMusic,\n    description: 'Generating your song...',\n  },\n  {\n    id: 'complete' as LoadingStep,\n    label: 'Complete',\n    icon: FiCheck,\n    description: 'Your song is ready!',\n  },\n];\n\nexport default function LoadingProgress({ currentStep, progress = 0 }: LoadingProgressProps) {\n  const currentStepIndex = steps.findIndex((s) => s.id === currentStep);\n\n  return (\n    <div className=\"w-full max-w-2xl mx-auto\">\n      <div className=\"space-y-6\">\n        {steps.map((step, index) => {\n          const Icon = step.icon;\n          const isActive = index === currentStepIndex;\n          const isComplete = index < currentStepIndex;\n          const isPending = index > currentStepIndex;\n\n          return (\n            <motion.div\n              key={step.id}\n              initial={{ opacity: 0, x: -20 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ delay: index * 0.1 }}\n              className=\"flex items-center gap-4\"\n            >\n              <div\n                className={`\n                  w-12 h-12 rounded-full flex items-center justify-center transition-all\n                  ${isComplete ? 'bg-green-500 text-white' : ''}\n                  ${isActive ? 'bg-rose-500 text-white animate-pulse' : ''}\n                  ${isPending ? 'bg-gray-200 text-gray-400' : ''}\n                `}\n              >\n                <Icon className=\"w-6 h-6\" />\n              </div>\n\n              <div className=\"flex-1\">\n                <h3\n                  className={`\n                    font-semibold text-sm transition-colors\n                    ${isActive || isComplete ? 'text-gray-900' : 'text-gray-400'}\n                  `}\n                >\n                  {step.label}\n                </h3>\n                <p\n                  className={`\n                    text-xs transition-colors\n                    ${isActive ? 'text-gray-600' : 'text-gray-400'}\n                  `}\n                >\n                  {step.description}\n                </p>\n\n                {isActive && progress > 0 && (\n                  <div className=\"mt-2\">\n                    <div className=\"h-1.5 bg-gray-200 rounded-full overflow-hidden\">\n                      <motion.div\n                        className=\"h-full bg-rose-500\"\n                        initial={{ width: 0 }}\n                        animate={{ width: `${progress}%` }}\n                        transition={{ duration: 0.3 }}\n                      />\n                    </div>\n                    <p className=\"text-xs text-gray-500 mt-1\">{progress}%</p>\n                  </div>\n                )}\n              </div>\n\n              {isComplete && (\n                <motion.div\n                  initial={{ scale: 0 }}\n                  animate={{ scale: 1 }}\n                  className=\"text-green-500\"\n                >\n                  <FiCheck className=\"w-5 h-5\" />\n                </motion.div>\n              )}\n            </motion.div>\n          );\n        })}\n      </div>\n\n      <div className=\"mt-8 text-center\">\n        <motion.div\n          animate={{ rotate: 360 }}\n          transition={{ duration: 2, repeat: Infinity, ease: 'linear' }}\n          className=\"inline-block\"\n        >\n          <FiMusic className=\"w-8 h-8 text-rose-500\" />\n        </motion.div>\n        <p className=\"mt-3 text-gray-600 text-sm\">\n          Creating your personalized breakup song...\n        </p>\n      </div>\n    </div>\n  );\n}\n","size_bytes":4069},"app/pricing/page.tsx":{"content":"\"use client\";\n\nimport { motion } from \"framer-motion\";\nimport Link from \"next/link\";\nimport { FaCheck, FaStar, FaCrown } from \"react-icons/fa\";\nimport { Header } from \"@/components/Header\";\nimport { Footer } from \"@/components/Footer\";\nimport { SubscriptionCTA } from \"@/components/SubscriptionCTA\";\n\nexport default function PricingPage() {\n  return (\n    <div className=\"min-h-screen\">\n      <Header />\n      \n      <main className=\"pt-32 pb-20\">\n        <div className=\"section-container\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n            className=\"text-center mb-16\"\n          >\n            <h1 className=\"text-5xl md:text-6xl font-bold text-gray-900 mb-6\">\n              Simple, Transparent Pricing\n            </h1>\n            <p className=\"text-xl text-gray-600 max-w-2xl mx-auto\">\n              Choose the plan that fits your healing journey. Start with a free preview, \n              upgrade when you're ready.\n            </p>\n          </motion.div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto mb-20\">\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6, delay: 0.1 }}\n              whileHover={{ y: -10 }}\n              className=\"card text-center\"\n            >\n              <h3 className=\"text-2xl font-bold text-gray-900 mb-2\">Free</h3>\n              <div className=\"text-5xl font-bold text-heartbreak-500 mb-6\">\n                $0\n              </div>\n              <ul className=\"space-y-4 text-left mb-8\">\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>10-second song previews</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>All song styles (Sad, Savage, Healing)</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>Share previews on social media</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>Unlimited song generations</span>\n                </li>\n              </ul>\n              <Link href=\"/story\">\n                <button className=\"btn-secondary w-full\">\n                  Try Free Now\n                </button>\n              </Link>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6, delay: 0.2 }}\n              whileHover={{ y: -10 }}\n              className=\"card text-center border-4 border-heartbreak-400 relative shadow-2xl\"\n            >\n              <div className=\"absolute -top-4 left-1/2 transform -translate-x-1/2 bg-heartbreak-500 text-white px-6 py-2 rounded-full text-sm font-bold shadow-lg\">\n                Most Popular\n              </div>\n              <div className=\"flex items-center justify-center mb-2\">\n                <FaStar className=\"text-heartbreak-500 text-2xl mr-2\" />\n                <h3 className=\"text-2xl font-bold text-gray-900\">Standard</h3>\n              </div>\n              <div className=\"text-5xl font-bold text-heartbreak-500 mb-6\">\n                $9\n                <span className=\"text-xl text-gray-500\">/month</span>\n              </div>\n              <ul className=\"space-y-4 text-left mb-8\">\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span className=\"font-medium\">5 full songs per month</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>All song styles</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>HD audio quality</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>Download MP3 files</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>Full social sharing</span>\n                </li>\n              </ul>\n              <Link href=\"/story\">\n                <button className=\"btn-primary w-full\">\n                  Get Started\n                </button>\n              </Link>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.6, delay: 0.3 }}\n              whileHover={{ y: -10 }}\n              className=\"card text-center\"\n            >\n              <div className=\"flex items-center justify-center mb-2\">\n                <FaCrown className=\"text-heartbreak-500 text-2xl mr-2\" />\n                <h3 className=\"text-2xl font-bold text-gray-900\">Premium</h3>\n              </div>\n              <div className=\"text-5xl font-bold text-heartbreak-500 mb-6\">\n                $19\n                <span className=\"text-xl text-gray-500\">/month</span>\n              </div>\n              <ul className=\"space-y-4 text-left mb-8\">\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span className=\"font-medium\">20 full songs per month</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>All Standard features</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span className=\"font-medium\">AI breakup advice</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span className=\"font-medium\">No-contact tips & guidance</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>Priority support</span>\n                </li>\n                <li className=\"flex items-start space-x-3\">\n                  <FaCheck className=\"text-heartbreak-500 mt-1 flex-shrink-0\" />\n                  <span>Early access to new features</span>\n                </li>\n              </ul>\n              <Link href=\"/story\">\n                <button className=\"btn-primary w-full\">\n                  Go Premium\n                </button>\n              </Link>\n            </motion.div>\n          </div>\n\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6, delay: 0.4 }}\n            className=\"max-w-3xl mx-auto\"\n          >\n            <div className=\"card bg-gradient-to-br from-heartbreak-50 to-white\">\n              <h3 className=\"text-2xl font-bold text-gray-900 mb-6 text-center\">\n                Frequently Asked Questions\n              </h3>\n              <div className=\"space-y-6\">\n                <div>\n                  <h4 className=\"font-bold text-gray-900 mb-2\">Can I cancel anytime?</h4>\n                  <p className=\"text-gray-600\">\n                    Yes! You can cancel your subscription at any time. No questions asked, \n                    and you'll keep access until the end of your billing period.\n                  </p>\n                </div>\n                <div>\n                  <h4 className=\"font-bold text-gray-900 mb-2\">What payment methods do you accept?</h4>\n                  <p className=\"text-gray-600\">\n                    We accept all major credit cards, debit cards, PayPal, and Apple Pay \n                    through our secure payment provider Paddle.\n                  </p>\n                </div>\n                <div>\n                  <h4 className=\"font-bold text-gray-900 mb-2\">Can I buy individual songs instead?</h4>\n                  <p className=\"text-gray-600\">\n                    Yes! You can purchase individual full songs for $2.99 each if you don't \n                    want a subscription. Just generate your song and choose the one-time purchase option.\n                  </p>\n                </div>\n                <div>\n                  <h4 className=\"font-bold text-gray-900 mb-2\">Do unused songs roll over?</h4>\n                  <p className=\"text-gray-600\">\n                    Song credits reset each month and don't roll over. This keeps our pricing \n                    simple and fair for everyone.\n                  </p>\n                </div>\n              </div>\n            </div>\n          </motion.div>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n}\n","size_bytes":9623},"lib/lyrics.ts":{"content":"import OpenAI from 'openai';\n\nconst openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });\n\nexport type SongStyle = 'sad' | 'savage' | 'healing' | 'vibe' | 'meme';\n\nexport interface LyricsGenerationParams {\n  story: string;\n  style: SongStyle;\n}\n\nexport interface GeneratedLyrics {\n  title: string;\n  lyrics: string;\n  genre: string;\n  mood: string;\n}\n\nconst stylePrompts: Record<SongStyle, string> = {\n  sad: 'Create emotional, melancholic lyrics about heartbreak with themes of loss, longing, and sadness. Use poetic imagery and vulnerable language. Think slow ballad or acoustic.',\n  savage: 'Create fierce, confident, empowering lyrics about moving on and being better off. Use bold, sassy language with attitude. Think upbeat pop or hip-hop with strong beats.',\n  healing: 'Create uplifting, hopeful lyrics about self-growth and healing after heartbreak. Focus on self-love, resilience, and positive outlook. Think inspirational pop or indie.',\n  vibe: 'Create chill, modern, relatable lyrics about the breakup experience with a laid-back tone. Use conversational language. Think lo-fi, R&B, or bedroom pop vibes.',\n  meme: 'Create humorous, self-aware, internet-culture lyrics that make fun of the breakup situation. Use memes, slang, and comedic exaggeration. Think TikTok-viral comedy song.',\n};\n\nexport async function generateLyrics(\n  params: LyricsGenerationParams\n): Promise<GeneratedLyrics> {\n  const { story, style } = params;\n\n  const systemPrompt = `You are an expert songwriter specializing in breakup songs. Generate creative, emotionally resonant lyrics based on the user's breakup story.\n\n${stylePrompts[style]}\n\nIMPORTANT INSTRUCTIONS:\n- Create lyrics for a 30-60 second song (1 verse + 1 chorus, about 8-16 lines total)\n- Make it personal and specific to the story provided\n- Use vivid imagery and emotional language\n- Ensure lyrics are singable and have good rhythm\n- Return response as JSON with: title, lyrics, genre, mood\n\nExample JSON format:\n{\n  \"title\": \"Song Title Here\",\n  \"lyrics\": \"Verse 1:\\\\nLine 1\\\\nLine 2\\\\n\\\\nChorus:\\\\nLine 1\\\\nLine 2\",\n  \"genre\": \"Pop Ballad\",\n  \"mood\": \"Melancholic\"\n}`;\n\n  try {\n    const response = await openai.chat.completions.create({\n      model: 'gpt-4o',\n      messages: [\n        { role: 'system', content: systemPrompt },\n        {\n          role: 'user',\n          content: `Create breakup song lyrics in a ${style} style based on this story:\\n\\n${story}`,\n        },\n      ],\n      response_format: { type: 'json_object' },\n      max_completion_tokens: 1000,\n    });\n\n    const result = JSON.parse(response.choices[0].message.content || '{}');\n\n    if (!result.title || !result.lyrics) {\n      throw new Error('Invalid lyrics format received from AI');\n    }\n\n    return {\n      title: result.title,\n      lyrics: result.lyrics,\n      genre: result.genre || 'Pop',\n      mood: result.mood || style,\n    };\n  } catch (error) {\n    console.error('Lyrics generation error:', error);\n    throw new Error('Failed to generate lyrics. Please try again.');\n  }\n}\n\nexport function summarizeStory(story: string): string {\n  const words = story.split(/\\s+/);\n  if (words.length <= 50) return story;\n  \n  return words.slice(0, 50).join(' ') + '...';\n}\n","size_bytes":3215},"app/api/ocr/route.ts":{"content":"import { NextRequest, NextResponse } from 'next/server';\nimport { extractTextFromImage, validateChatScreenshot } from '@/lib/ocr';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const formData = await request.formData();\n    const image = formData.get('image') as File;\n\n    if (!image) {\n      return NextResponse.json(\n        { success: false, error: 'No image provided' },\n        { status: 400 }\n      );\n    }\n\n    if (!image.type.startsWith('image/')) {\n      return NextResponse.json(\n        { success: false, error: 'File must be an image' },\n        { status: 400 }\n      );\n    }\n\n    const arrayBuffer = await image.arrayBuffer();\n    const buffer = Buffer.from(arrayBuffer);\n    const base64 = buffer.toString('base64');\n    const dataUrl = `data:${image.type};base64,${base64}`;\n\n    const ocrResult = await extractTextFromImage(dataUrl);\n\n    const validation = validateChatScreenshot(ocrResult.cleanedText);\n    if (!validation.isValid) {\n      return NextResponse.json(\n        { success: false, error: validation.reason },\n        { status: 400 }\n      );\n    }\n\n    return NextResponse.json({\n      success: true,\n      rawText: ocrResult.text,\n      cleanedText: ocrResult.cleanedText,\n      confidence: ocrResult.confidence,\n    });\n  } catch (error) {\n    console.error('OCR API Error:', error);\n    return NextResponse.json(\n      {\n        success: false,\n        error: error instanceof Error ? error.message : 'Failed to process image',\n      },\n      { status: 500 }\n    );\n  }\n}\n","size_bytes":1525},"lib/ocr.ts":{"content":"import Tesseract from 'tesseract.js';\n\nexport interface OCRResult {\n  text: string;\n  confidence: number;\n  cleanedText: string;\n}\n\nexport async function extractTextFromImage(\n  imageData: string | File,\n  onProgress?: (progress: number) => void\n): Promise<OCRResult> {\n  try {\n    const result = await Tesseract.recognize(imageData, 'eng', {\n      logger: (m) => {\n        if (m.status === 'recognizing text' && onProgress) {\n          onProgress(Math.round(m.progress * 100));\n        }\n      },\n    });\n\n    const rawText = result.data.text;\n    const confidence = result.data.confidence;\n    const cleanedText = cleanExtractedText(rawText);\n\n    return {\n      text: rawText,\n      confidence,\n      cleanedText,\n    };\n  } catch (error) {\n    console.error('OCR Error:', error);\n    throw new Error('Failed to extract text from image. Please try a clearer screenshot.');\n  }\n}\n\nexport function cleanExtractedText(text: string): string {\n  let cleaned = text;\n\n  cleaned = cleaned.replace(/\\d{1,2}:\\d{2}\\s?(AM|PM|am|pm)?/g, '');\n  \n  cleaned = cleaned.replace(/\\d{1,2}\\/\\d{1,2}\\/\\d{2,4}/g, '');\n  cleaned = cleaned.replace(/\\d{4}-\\d{2}-\\d{2}/g, '');\n  \n  cleaned = cleaned.replace(/Read\\s+\\d+:\\d{2}\\s?(AM|PM)?/gi, '');\n  cleaned = cleaned.replace(/Delivered|Read|Sent|Typing\\.\\.\\./gi, '');\n  \n  cleaned = cleaned.replace(/[\\u{1F300}-\\u{1F9FF}]/gu, '');\n  cleaned = cleaned.replace(/[\\u{2600}-\\u{27BF}]/gu, '');\n  \n  cleaned = cleaned.replace(/^[A-Za-z\\s]+:/gm, '');\n  \n  cleaned = cleaned.replace(/\\n{3,}/g, '\\n\\n');\n  \n  cleaned = cleaned.replace(/^\\s+|\\s+$/gm, '');\n  \n  cleaned = cleaned.trim();\n\n  return cleaned;\n}\n\nexport function validateChatScreenshot(text: string): {\n  isValid: boolean;\n  reason?: string;\n} {\n  if (!text || text.trim().length < 10) {\n    return {\n      isValid: false,\n      reason: 'Not enough text detected. Please upload a clearer screenshot.',\n    };\n  }\n\n  const wordCount = text.split(/\\s+/).length;\n  if (wordCount < 5) {\n    return {\n      isValid: false,\n      reason: 'Screenshot appears too short. Make sure the chat messages are visible.',\n    };\n  }\n\n  return { isValid: true };\n}","size_bytes":2125},"components/AnimatedBackground.tsx":{"content":"'use client';\n\nimport { motion } from 'framer-motion';\n\nexport function AnimatedBackground() {\n  const hearts = Array.from({ length: 8 }, (_, i) => ({\n    id: i,\n    delay: i * 2,\n    duration: 15 + Math.random() * 10,\n    x: Math.random() * 100,\n  }));\n\n  const notes = Array.from({ length: 12 }, (_, i) => ({\n    id: i,\n    delay: i * 1.5,\n    duration: 12 + Math.random() * 8,\n    x: Math.random() * 100,\n    emoji: ['üéµ', 'üé∂', '‚ô™', '‚ô´'][Math.floor(Math.random() * 4)],\n  }));\n\n  return (\n    <div className=\"fixed inset-0 -z-10 overflow-hidden pointer-events-none\">\n      <motion.div\n        className=\"absolute inset-0 bg-gradient-to-br from-heartbreak-50 via-pink-50 to-purple-50\"\n        animate={{\n          background: [\n            'linear-gradient(to bottom right, #fef2f2, #fce7f3, #f5f3ff)',\n            'linear-gradient(to bottom right, #fce7f3, #f5f3ff, #fef2f2)',\n            'linear-gradient(to bottom right, #f5f3ff, #fef2f2, #fce7f3)',\n            'linear-gradient(to bottom right, #fef2f2, #fce7f3, #f5f3ff)',\n          ],\n        }}\n        transition={{\n          duration: 20,\n          repeat: Infinity,\n          ease: 'linear',\n        }}\n      />\n\n      {hearts.map((heart) => (\n        <motion.div\n          key={`heart-${heart.id}`}\n          className=\"absolute text-4xl opacity-20\"\n          initial={{\n            x: `${heart.x}%`,\n            y: '110%',\n            rotate: 0,\n            scale: 0.5,\n          }}\n          animate={{\n            y: '-10%',\n            rotate: 360,\n            scale: [0.5, 1, 0.8, 1, 0.5],\n          }}\n          transition={{\n            duration: heart.duration,\n            delay: heart.delay,\n            repeat: Infinity,\n            ease: 'linear',\n          }}\n        >\n          üíî\n        </motion.div>\n      ))}\n\n      {notes.map((note) => (\n        <motion.div\n          key={`note-${note.id}`}\n          className=\"absolute text-3xl opacity-20\"\n          initial={{\n            x: `${note.x}%`,\n            y: '110%',\n            rotate: -45,\n          }}\n          animate={{\n            y: '-10%',\n            rotate: 45,\n            x: `${note.x + 10}%`,\n          }}\n          transition={{\n            duration: note.duration,\n            delay: note.delay,\n            repeat: Infinity,\n            ease: 'easeInOut',\n          }}\n        >\n          {note.emoji}\n        </motion.div>\n      ))}\n\n      <motion.div\n        className=\"absolute top-1/4 left-1/4 w-96 h-96 bg-heartbreak-200 rounded-full filter blur-3xl opacity-20\"\n        animate={{\n          scale: [1, 1.2, 1],\n          x: [0, 50, 0],\n          y: [0, -30, 0],\n        }}\n        transition={{\n          duration: 8,\n          repeat: Infinity,\n          ease: 'easeInOut',\n        }}\n      />\n\n      <motion.div\n        className=\"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-200 rounded-full filter blur-3xl opacity-20\"\n        animate={{\n          scale: [1, 1.3, 1],\n          x: [0, -50, 0],\n          y: [0, 30, 0],\n        }}\n        transition={{\n          duration: 10,\n          repeat: Infinity,\n          ease: 'easeInOut',\n        }}\n      />\n    </div>\n  );\n}\n","size_bytes":3145},"components/LyricsOverlay.tsx":{"content":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { useEffect, useState } from 'react';\n\ninterface LyricsOverlayProps {\n  lyrics: string;\n  duration?: number;\n  isPlaying: boolean;\n}\n\nexport function LyricsOverlay({ lyrics, duration = 60, isPlaying }: LyricsOverlayProps) {\n  const [scrollPosition, setScrollPosition] = useState(0);\n\n  const lyricsLines = lyrics.split('\\n').filter(line => line.trim() !== '');\n\n  useEffect(() => {\n    if (!isPlaying) {\n      setScrollPosition(0);\n      return;\n    }\n\n    const totalLines = lyricsLines.length;\n    const pixelsPerSecond = (totalLines * 80) / duration;\n\n    const interval = setInterval(() => {\n      setScrollPosition(prev => {\n        const newPosition = prev + (pixelsPerSecond / 30);\n        if (newPosition >= totalLines * 80) {\n          return 0;\n        }\n        return newPosition;\n      });\n    }, 1000 / 30);\n\n    return () => clearInterval(interval);\n  }, [isPlaying, duration, lyricsLines.length]);\n\n  useEffect(() => {\n    setScrollPosition(0);\n  }, [duration]);\n\n  return (\n    <div className=\"relative w-full h-64 md:h-96 overflow-hidden rounded-2xl bg-gradient-to-br from-heartbreak-50 to-white border border-heartbreak-200\">\n      <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\n        <div className=\"absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-white opacity-80\"></div>\n        <div className=\"absolute inset-0 bg-gradient-to-t from-transparent via-transparent to-white opacity-80\"></div>\n      </div>\n\n      <motion.div\n        className=\"relative px-8 py-12\"\n        animate={{\n          y: -scrollPosition,\n        }}\n        transition={{\n          duration: 0,\n        }}\n      >\n        <div className=\"space-y-6\">\n          {lyricsLines.map((line, index) => (\n            <motion.p\n              key={index}\n              initial={{ opacity: 0.3 }}\n              animate={{\n                opacity: isPlaying ? [0.3, 1, 1, 0.3] : 0.5,\n                scale: isPlaying ? [1, 1.05, 1.05, 1] : 1,\n              }}\n              transition={{\n                duration: duration / lyricsLines.length,\n                delay: (index * duration) / lyricsLines.length,\n                repeat: Infinity,\n                repeatDelay: 0,\n              }}\n              className=\"text-xl md:text-3xl font-bold text-center text-gray-800 leading-relaxed\"\n              style={{\n                textShadow: '2px 2px 4px rgba(255,255,255,0.8)',\n              }}\n            >\n              {line}\n            </motion.p>\n          ))}\n        </div>\n      </motion.div>\n\n      {!isPlaying && (\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <motion.div\n            initial={{ scale: 0.9, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            className=\"text-center\"\n          >\n            <p className=\"text-2xl md:text-3xl font-bold text-gray-500\">\n              ‚ñ∂Ô∏è Press play to see lyrics\n            </p>\n          </motion.div>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":3079},"lib/openrouter.ts":{"content":"import axios from 'axios';\n\nexport interface OpenRouterParams {\n  extractedText: string;\n  style: string;\n}\n\nexport interface OpenRouterResult {\n  prompt: string;\n  title: string;\n  tags: string;\n}\n\nexport class OpenRouterAPI {\n  private apiKey: string;\n  private baseUrl = 'https://openrouter.ai/api/v1';\n\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n  }\n\n  async generateSongPrompt(params: OpenRouterParams): Promise<OpenRouterResult> {\n    if (!this.apiKey || this.apiKey === '') {\n      throw new Error('OpenRouter API key not configured');\n    }\n\n    const styleDescriptions = {\n      sad: 'sad, melancholic, heartbreak, emotional, slow tempo',\n      savage: 'empowering, confident, revenge, upbeat, sassy',\n      healing: 'hopeful, uplifting, growth, peaceful, moving on',\n      vibe: 'chill, smooth, atmospheric, laid-back',\n      meme: 'funny, quirky, humorous, playful, ironic',\n    };\n\n    const systemPrompt = `You are an AI assistant that helps clean up extracted text from images (OCR) and generates Suno AI prompts for song generation.\n\nYour task is to:\n1. Clean up any OCR errors or garbled text from the user's story\n2. Create a catchy song title (max 50 characters)\n3. Generate music genre/style tags (max 80 characters) - be specific with musical styles\n4. Create a descriptive prompt for Suno AI that captures the story's emotion and the requested style\n\nThe prompt should describe the song's theme, emotion, and narrative arc - NOT full lyrics. Suno AI will generate the actual lyrics and music.\n\nStyle requested: ${params.style} (${styleDescriptions[params.style as keyof typeof styleDescriptions] || 'emotional'})\n\nReturn your response in this exact JSON format:\n{\n  \"title\": \"Song Title Here\",\n  \"tags\": \"genre, style, mood, tempo\",\n  \"prompt\": \"A descriptive prompt for Suno AI about the song's theme, emotion, and narrative\"\n}`;\n\n    try {\n      const response = await axios.post(\n        `${this.baseUrl}/chat/completions`,\n        {\n          model: 'mistralai/mistral-7b-instruct:free',\n          messages: [\n            {\n              role: 'system',\n              content: systemPrompt,\n            },\n            {\n              role: 'user',\n              content: `Clean up this text and create a Suno AI prompt for a ${params.style} HeartHeal song:\\n\\n${params.extractedText}`,\n            },\n          ],\n          response_format: { type: 'json_object' },\n          temperature: 0.8,\n        },\n        {\n          headers: {\n            'Authorization': `Bearer ${this.apiKey}`,\n            'Content-Type': 'application/json',\n            'HTTP-Referer': 'https://heartheal.app',\n            'X-Title': 'HeartHeal',\n          },\n        }\n      );\n\n      const content = response.data.choices[0].message.content;\n      let parsed;\n\n      try {\n        parsed = JSON.parse(content);\n      } catch (parseError) {\n        console.error('Failed to parse OpenRouter response as JSON:', content);\n        throw new Error('Invalid response format from AI model');\n      }\n\n      if (!parsed || typeof parsed !== 'object') {\n        throw new Error('AI returned invalid data structure');\n      }\n\n      const defaultTags = styleDescriptions[params.style as keyof typeof styleDescriptions] || 'emotional';\n      \n      return {\n        prompt: parsed.prompt || parsed.lyrics || parsed.lyric || '',\n        title: parsed.title || `${params.style.charAt(0).toUpperCase() + params.style.slice(1)} HeartHeal Anthem`,\n        tags: parsed.tags || parsed.genre || defaultTags,\n      };\n    } catch (error: any) {\n      console.error('OpenRouter API Error:', error.response?.data || error.message);\n      \n      if (error.response?.status === 401) {\n        throw new Error('Invalid OpenRouter API key. Please check your configuration.');\n      }\n      \n      if (error.response?.status === 402) {\n        throw new Error('Insufficient OpenRouter credits. Please add more credits.');\n      }\n\n      throw new Error(\n        `Failed to generate prompt with OpenRouter: ${error.response?.data?.error?.message || error.message}`\n      );\n    }\n  }\n}\n\nexport function createOpenRouterClient(): OpenRouterAPI {\n  const apiKey = process.env.OPENROUTER_API_KEY || '';\n  return new OpenRouterAPI(apiKey);\n}\n","size_bytes":4234},"lib/suno.ts":{"content":"import axios from 'axios';\n\nexport interface SunoGenerationParams {\n  prompt: string;\n  title: string;\n  style: string;\n  tags?: string;\n  make_instrumental?: boolean;\n}\n\nexport interface SunoGenerationResult {\n  id: string;\n  audioUrl: string;\n  videoUrl?: string;\n  lyrics?: string;\n  duration?: number;\n  status: string;\n}\n\nexport class SunoAPI {\n  private apiKey: string;\n  private baseUrl = 'https://api.sunoapi.org/v1/suno';\n\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n  }\n\n  async generateSong(params: SunoGenerationParams): Promise<SunoGenerationResult> {\n    if (!this.apiKey || this.apiKey === '') {\n      throw new Error('Suno API key not configured');\n    }\n\n    try {\n      console.log('Creating song with Suno AI...');\n      \n      const createResponse = await axios.post(\n        `${this.baseUrl}/create`,\n        {\n          custom_mode: true,\n          title: params.title,\n          tags: params.tags || params.style,\n          prompt: params.prompt,\n          make_instrumental: params.make_instrumental || false,\n          mv: 'chirp-v4',\n        },\n        {\n          headers: {\n            'Authorization': `Bearer ${this.apiKey}`,\n            'Content-Type': 'application/json',\n          },\n        }\n      );\n\n      const taskId = createResponse.data.data?.id || createResponse.data.id;\n      \n      if (!taskId) {\n        throw new Error('No task ID returned from Suno API');\n      }\n\n      console.log('Song task created, polling for completion...');\n      \n      const result = await this.pollForCompletion(taskId);\n      \n      return result;\n    } catch (error: any) {\n      console.error('Suno API Error:', error.response?.data || error.message);\n      \n      if (error.response?.status === 401) {\n        throw new Error('Invalid Suno API key. Please check your configuration.');\n      }\n      \n      if (error.response?.status === 402) {\n        throw new Error('Insufficient Suno API credits. Please add more credits.');\n      }\n      \n      if (error.response?.status === 429) {\n        throw new Error('Suno API rate limit exceeded. Please try again later.');\n      }\n\n      throw new Error(\n        `Failed to generate music with Suno: ${error.response?.data?.error || error.message}`\n      );\n    }\n  }\n\n  private async pollForCompletion(taskId: string, maxAttempts = 60): Promise<SunoGenerationResult> {\n    for (let attempt = 0; attempt < maxAttempts; attempt++) {\n      await this.sleep(3000);\n\n      try {\n        const response = await axios.get(\n          `${this.baseUrl}/get?id=${taskId}`,\n          {\n            headers: {\n              'Authorization': `Bearer ${this.apiKey}`,\n            },\n          }\n        );\n\n        const songs = response.data.data || response.data;\n        const song = Array.isArray(songs) ? songs[0] : songs;\n\n        if (song && song.status === 'complete' && song.audio_url) {\n          console.log('Song generation complete!');\n          \n          const audioUrl = song.audio_url;\n          const videoUrl = song.video_url || audioUrl;\n          \n          return {\n            id: song.id,\n            audioUrl: audioUrl,\n            videoUrl: videoUrl,\n            lyrics: song.lyric || song.prompt,\n            duration: song.duration || 60,\n            status: 'complete',\n          };\n        }\n\n        if (song && song.status === 'error') {\n          throw new Error('Song generation failed');\n        }\n\n        console.log(`Polling attempt ${attempt + 1}/${maxAttempts}...`);\n      } catch (error: any) {\n        if (attempt === maxAttempts - 1) {\n          throw error;\n        }\n      }\n    }\n\n    throw new Error('Song generation timed out');\n  }\n\n  private sleep(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n}\n\nexport function createSunoClient(): SunoAPI {\n  const apiKey = process.env.SUNO_API_KEY || '';\n  return new SunoAPI(apiKey);\n}\n","size_bytes":3896},"components/SubscriptionModal.tsx":{"content":"'use client';\n\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { FaTimes, FaCheck } from 'react-icons/fa';\nimport Link from 'next/link';\n\ninterface SubscriptionModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function SubscriptionModal({ isOpen, onClose }: SubscriptionModalProps) {\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          exit={{ opacity: 0 }}\n          className=\"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4\"\n          onClick={onClose}\n        >\n          <motion.div\n            initial={{ scale: 0.9, opacity: 0, y: 20 }}\n            animate={{ scale: 1, opacity: 1, y: 0 }}\n            exit={{ scale: 0.9, opacity: 0, y: 20 }}\n            transition={{ type: 'spring', duration: 0.5 }}\n            className=\"bg-white rounded-3xl p-8 max-w-md w-full shadow-2xl relative\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <button\n              onClick={onClose}\n              className=\"absolute top-6 right-6 text-gray-400 hover:text-gray-600 transition-colors\"\n            >\n              <FaTimes className=\"text-xl\" />\n            </button>\n\n            <div className=\"text-center space-y-6\">\n              <motion.div\n                initial={{ scale: 0 }}\n                animate={{ scale: 1 }}\n                transition={{ delay: 0.2, type: 'spring' }}\n                className=\"w-20 h-20 mx-auto bg-gradient-to-br from-rose-500 to-purple-500 rounded-full flex items-center justify-center\"\n              >\n                <span className=\"text-4xl\">üéµ</span>\n              </motion.div>\n\n              <div>\n                <h2 className=\"text-2xl md:text-3xl font-bold text-gray-900 mb-2\">\n                  Love your song?\n                </h2>\n                <p className=\"text-gray-600\">\n                  Get unlimited songs for $9/month\n                </p>\n              </div>\n\n              <div className=\"bg-gradient-to-br from-rose-50 to-purple-50 rounded-2xl p-6 space-y-3 text-left\">\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0 w-6 h-6 bg-rose-500 rounded-full flex items-center justify-center mt-0.5\">\n                    <FaCheck className=\"text-white text-xs\" />\n                  </div>\n                  <p className=\"text-gray-700\">Unlimited songs, any time</p>\n                </div>\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0 w-6 h-6 bg-rose-500 rounded-full flex items-center justify-center mt-0.5\">\n                    <FaCheck className=\"text-white text-xs\" />\n                  </div>\n                  <p className=\"text-gray-700\">No watermark on downloads</p>\n                </div>\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0 w-6 h-6 bg-rose-500 rounded-full flex items-center justify-center mt-0.5\">\n                    <FaCheck className=\"text-white text-xs\" />\n                  </div>\n                  <p className=\"text-gray-700\">Priority song generation</p>\n                </div>\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0 w-6 h-6 bg-rose-500 rounded-full flex items-center justify-center mt-0.5\">\n                    <FaCheck className=\"text-white text-xs\" />\n                  </div>\n                  <p className=\"text-gray-700\">Cancel anytime, no commitment</p>\n                </div>\n              </div>\n\n              <div className=\"space-y-3\">\n                <Link href=\"/pricing\">\n                  <motion.button\n                    whileHover={{ scale: 1.05 }}\n                    whileTap={{ scale: 0.95 }}\n                    className=\"w-full bg-gradient-to-r from-rose-500 to-purple-500 hover:from-rose-600 hover:to-purple-600 text-white px-8 py-4 rounded-full font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300\"\n                  >\n                    Subscribe Now\n                  </motion.button>\n                </Link>\n                <button\n                  onClick={onClose}\n                  className=\"w-full text-gray-600 hover:text-gray-800 font-medium transition-colors\"\n                >\n                  Maybe Later\n                </button>\n              </div>\n\n              <p className=\"text-xs text-gray-500\">\n                Join 10,000+ users healing through music\n              </p>\n            </div>\n          </motion.div>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n}\n","size_bytes":4679},"components/AnalysisScreen.tsx":{"content":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { useEffect, useState } from 'react';\n\ninterface AnalysisScreenProps {\n  onComplete: () => void;\n  uploadedImage?: boolean;\n}\n\nexport function AnalysisScreen({ onComplete, uploadedImage = false }: AnalysisScreenProps) {\n  const [progress, setProgress] = useState(0);\n  const [currentPhase, setCurrentPhase] = useState(0);\n\n  // Generate random analysis data for MVP\n  const redFlagLevels = ['Low', 'Medium', 'High'];\n  const redFlagLevel = redFlagLevels[Math.floor(Math.random() * redFlagLevels.length)];\n  const heartbreakIntensity = Math.floor(Math.random() * 4) + 7; // 7-10\n  const recommendedVibes = ['Sad', 'Savage', 'Healing', 'Vibe', 'Meme'];\n  const recommendedVibe = recommendedVibes[Math.floor(Math.random() * recommendedVibes.length)];\n\n  const getRedFlagEmoji = (level: string) => {\n    switch (level) {\n      case 'High': return 'üö©üö©üö©';\n      case 'Medium': return 'üö©üö©';\n      default: return 'üö©';\n    }\n  };\n\n  useEffect(() => {\n    // Progress bar animation\n    const progressInterval = setInterval(() => {\n      setProgress((prev) => {\n        if (prev >= 100) {\n          clearInterval(progressInterval);\n          return 100;\n        }\n        return prev + 2;\n      });\n    }, 50);\n\n    // Phase transitions\n    const phaseTimeout1 = setTimeout(() => setCurrentPhase(1), 1000);\n    const phaseTimeout2 = setTimeout(() => setCurrentPhase(2), 2000);\n    const phaseTimeout3 = setTimeout(() => setCurrentPhase(3), 3000);\n    const completeTimeout = setTimeout(() => {\n      onComplete();\n    }, 5000);\n\n    return () => {\n      clearInterval(progressInterval);\n      clearTimeout(phaseTimeout1);\n      clearTimeout(phaseTimeout2);\n      clearTimeout(phaseTimeout3);\n      clearTimeout(completeTimeout);\n    };\n  }, [onComplete]);\n\n  return (\n    <div className=\"fixed inset-0 bg-gradient-to-br from-rose-50 via-pink-50 to-purple-50 z-50 flex items-center justify-center p-4\">\n      <motion.div\n        initial={{ opacity: 0, scale: 0.9 }}\n        animate={{ opacity: 1, scale: 1 }}\n        className=\"bg-white rounded-3xl p-8 md:p-12 max-w-lg w-full shadow-2xl\"\n      >\n        <div className=\"space-y-8\">\n          {/* Header */}\n          <div className=\"text-center\">\n            <motion.div\n              animate={{ rotate: 360 }}\n              transition={{ duration: 2, repeat: Infinity, ease: \"linear\" }}\n              className=\"w-16 h-16 mx-auto mb-4\"\n            >\n              <div className=\"w-full h-full rounded-full bg-gradient-to-br from-rose-400 to-purple-500 flex items-center justify-center\">\n                <span className=\"text-3xl\">üíî</span>\n              </div>\n            </motion.div>\n            <h2 className=\"text-2xl md:text-3xl font-bold text-gray-900 mb-2\">\n              {uploadedImage ? 'Analyzing your conversation...' : 'Creating your song...'}\n            </h2>\n            <p className=\"text-gray-600\">\n              {uploadedImage ? 'Reading between the lines' : 'Turning your feelings into music'}\n            </p>\n          </div>\n\n          {/* Progress Bar */}\n          <div className=\"w-full bg-gray-200 rounded-full h-2 overflow-hidden\">\n            <motion.div\n              className=\"h-full bg-gradient-to-r from-rose-500 to-purple-500\"\n              initial={{ width: '0%' }}\n              animate={{ width: `${progress}%` }}\n              transition={{ duration: 0.3 }}\n            />\n          </div>\n\n          {/* Analysis Results (only show for uploaded images) */}\n          {uploadedImage && (\n            <div className=\"space-y-4\">\n              <AnimatePresence>\n                {currentPhase >= 1 && (\n                  <motion.div\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    className=\"bg-gradient-to-r from-red-50 to-pink-50 rounded-xl p-4 border border-red-200\"\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-700 font-medium\">{getRedFlagEmoji(redFlagLevel)} Red flag level:</span>\n                      <span className={`font-bold ${\n                        redFlagLevel === 'High' ? 'text-red-600' :\n                        redFlagLevel === 'Medium' ? 'text-orange-600' :\n                        'text-yellow-600'\n                      }`}>\n                        {redFlagLevel}\n                      </span>\n                    </div>\n                  </motion.div>\n                )}\n\n                {currentPhase >= 2 && (\n                  <motion.div\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-200\"\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-700 font-medium\">üíî Heartbreak intensity:</span>\n                      <span className=\"font-bold text-purple-600\">{heartbreakIntensity}/10</span>\n                    </div>\n                  </motion.div>\n                )}\n\n                {currentPhase >= 3 && (\n                  <motion.div\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    className=\"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-200\"\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-gray-700 font-medium\">üéµ Recommended vibe:</span>\n                      <span className=\"font-bold text-blue-600\">{recommendedVibe}</span>\n                    </div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </div>\n          )}\n\n          {/* Loading message */}\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            transition={{ delay: 3.5 }}\n            className=\"text-center\"\n          >\n            <p className=\"text-gray-600 font-medium\">\n              Generating your personalized breakup anthem...\n            </p>\n          </motion.div>\n        </div>\n      </motion.div>\n    </div>\n  );\n}\n\n// Fix AnimatePresence import\nimport { AnimatePresence } from 'framer-motion';\n","size_bytes":6398}},"version":2}